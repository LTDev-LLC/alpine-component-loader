{"version":3,"sources":["../src/index.js"],"names":["styleSheetCache","Map","scriptLoadCache","typeMap","String","Number","Boolean","Array","Object","dataFetchCache","toCssString","styleObj","entries","map","k","v","replace","m","toLowerCase","join","toUrlValue","encodeURIComponent","JSON","stringify","toSearchParamsDeep","obj","_params","URLSearchParams","add","key","value","isArray","forEach","append","AlpineComponentLoader","start","_started","pruneCaches","registerComponent","registerDynamicLoader","registerTemplates","prefix","current","globalConfig","_templateCachePrefix","_templateCacheKey","window","Promise","all","caches","keys","filter","startsWith","delete","clearCache","console","warn","config","options","assign","name","defaultComponentName","customElements","get","define","AlpineDeclarativeLoader","defaultDynamicName","AlpineDynamicLoader","document","querySelectorAll","tpl","tagName","getAttribute","attributes","fromEntries","parse","val","type","e","toggleDebug","prefetch","_registry","loadTemplate","source","settings","el","useCache","faH","_cache","match","fetchedAt","res","clone","headers","HTMLTemplateElement","content","querySelector","reject","Error","cacheTemplates","open","ok","isNaN","Date","now","_templateCacheExpire","text","fetch","cache","status","Headers","set","toString","put","Response","body","statusText","ReadableStream","pipeThrough","TextDecoderStream","loading","hooks","beforeFetch","opts","afterFetch","data","externalCss","externalScripts","sharedStyleSheets","errorCss","display","flexDirection","gap","padding","border","backgroundColor","color","borderRadius","fontFamily","fontSize","forwardEvents","fallback","persist","persistKey","persistDebounce","bindStore","dataSrc","dataFetchParams","dataFetchKeys","dataFetchPoll","dataFetchTimeout","dataFetchOptions","observedAttrs","Set","contentSource","basePath","helpers","_this","$emit","detail","dispatchEvent","CustomEvent","bubbles","composed","$reload","reload","AlpineExternalComponent","_$props","$data","$loading","$error","$lastUpdated","_initialized","_loading","_disconnectTimeout","_fetchAbortController","$props","Alpine","reactive","_root","shadow","attachShadow","mode","_observer","_scopeId","Math","random","slice","_slotObserver","_originalLightDom","createDocumentFragment","_pollTimer","attributeChangedCallback","oldVal","newVal","includes","_fetchData","_startPolling","_updateProp","_triggerHook","connectedCallback","setAttribute","clearTimeout","_syncAllAttributes","loadMode","_initLazyObserver","_initIdleLoader","_load","disconnectedCallback","_stopPolling","disconnect","_isKeptAlive","hasAttribute","setTimeout","isConnected","abort","destroyTree","interval","parseInt","src","placeholder","createElement","style","minHeight","appendChild","IntersectionObserver","isIntersecting","rootMargin","observe","requestIdleCallback","timeout","_initSlotObserver","MutationObserver","mutations","mutation","addedNodes","node","nodeType","Node","ELEMENT_NODE","TEXT_NODE","slotName","container","childList","currentDataSrc","log","startMark","promises","lightSlots","err","fallbackSource","fallbackErr","performance","length","_loadExternalDependencies","resolve","_resolveContent","_captureLightSlots","replaceChildren","url","link","rel","href","_renderSafe","_setupEventForwarding","_initAlpine","_perf","duration","_dispatch","error","_renderError","message","skipCache","signal","timeoutId","resolveValue","params","resolvedUrl","finalUrl","fetchTask","json","processedData","modified","AbortController","attrName","configVal","result","attrVal","context","trimmed","evaled","$el","props","root","$root","trim","Function","call","URL","location","origin","search","has","contentType","method","catch","race","_","addEventListener","once","aborted","reason","fetchTimeout","hookName","head","p","script","async","onload","onerror","push","firstChild","from","childNodes","reduce","slots","concat","default","rootNode","reader","decoder","accumulator","done","doc","styles","combinedCss","sheet","scripts","getReader","TextDecoder","read","decode","stream","DOMParser","parseFromString","cloneNode","stripStyles","useConstructibleStyles","adoptedStyleSheets","s","textContent","CSSStyleSheet","replaceSync","remove","scopeSelector","executeScripts","oldScript","newScript","attr","slotEl","anchor","nodesToInsert","replaceWith","eventName","configDef","required","validator","defaultValue","hasOwnProperty","undefined","schema","_applyTypeDefault","parsedValue","num","some","t","_initPersistence","storage","localStorage","sessionStorage","localName","id","debounceMs","_timer","getSnapshot","saveNow","setItem","$persistence","$key","$save","$clear","removeItem","$get","stored","getItem","$flush","prototype","effect","_finishAlpineInit","storeName","store","children","nextTick","initTree","msg","cssText","header","code","marginTop","_pruneCache","pruneCache","_clearCache","observedAttributes","HTMLElement","_debugger","debug","_templateCacheVersion","inferredType","realElement","split","pop","shift","_switch","firstElementChild","clear","tag","updateDOM","keepAlive","_savedScroll","scrollTop","startViewTransition","transition","opacity","r","requestAnimationFrame","readyState"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;CAOC,GAED,6DAA6D;AAC7D,IAAMA,kBAAkB,IAAIC;AAE5B,yEAAyE;AACzE,IAAMC,kBAAkB,IAAID;AAE5B,0CAA0C;AAC1C,IAAME,UAAU;IACZ,UAAUC;IACV,UAAUC;IACV,WAAWC;IACX,SAASC;IACT,UAAUC;AACd;AAEA,iEAAiE;AACjE,IAAMC,iBAAiB,IAAIR;AAE3B,oDAAoD;AACpD,IAAMS,cAAc,qBAACC;IACjB,OAAOH,OAAOI,OAAO,CAACD,UACjBE,GAAG,CAAC;iDAAEC,eAAGC;eAAO,AAAC,GAAqDA,OAAnDD,EAAEE,OAAO,CAAC,UAAUC,SAAAA;mBAAK,AAAC,IAAmB,OAAhBA,EAAEC,WAAW;YAAM,KAAK,OAAFH;OACtEI,IAAI,CAAC;AACd;AAEA,gFAAgF;AAChF,IAAMC,aAAa,oBAACL;WAAMM,mBAAmB,AAAC,CAAA,OAAON,kCAAP,SAAOA,EAAAA,MAAM,YAAYA,MAAM,OAAQO,KAAKC,SAAS,CAACR,KAAKA;;AAEzG,uFAAuF;AACvF,SAASS,mBAAmBC,GAAG;IAC3B,IAAMC,UAAU,IAAIC,mBAChB,wDAAwD;IACxDC,MAAM,cAACC,KAAKC;QACR,IAAIA,SAAS,MACT;QAEJ,iBAAiB;QACjB,IAAIvB,MAAMwB,OAAO,CAACD,QACd,OAAOA,MAAME,OAAO,CAAC,SAACjB;mBAAMa,IAAIC,KAAKd;;QAEzC,yBAAyB;QACzB,IAAI,CAAA,OAAOe,sCAAP,SAAOA,MAAI,MAAM,UAAU;gBACtB,kCAAA,2BAAA;;gBAAL,QAAK,YAAgBtB,OAAOI,OAAO,CAACkB,2BAA/B,SAAA,6BAAA,QAAA,yBAAA;oBAAA,mCAAA,iBAAOhB,oBAAGC;oBACXa,IAAI,AAAC,GAASd,OAAPe,KAAI,KAAK,OAAFf,GAAE,MAAIC;;;gBADnB;gBAAA;;;yBAAA,6BAAA;wBAAA;;;wBAAA;8BAAA;;;;YAEL;QACJ;QAEA,gBAAgB;QAChBW,QAAQO,MAAM,CAACJ,KAAKT,WAAWU;IACnC;QAGC,kCAAA,2BAAA;;QADL,iBAAiB;QACjB,QAAK,YAAgBtB,OAAOI,OAAO,CAACa,gBAAAA,iBAAAA,MAAO,CAAC,uBAAvC,SAAA,6BAAA,QAAA,yBAAA;YAAA,mCAAA,iBAAOX,oBAAGC;YACXa,IAAId,GAAGC;;;QADN;QAAA;;;iBAAA,6BAAA;gBAAA;;;gBAAA;sBAAA;;;;IAGL,OAAOW;AACX;AAEe,IAAA,AAAMQ,sCAAN;;aAAMA;gCAAAA;;kBAAAA;;YAoCJC,KAAAA;mBADb,AACA,mDADmD;YACnD,SAAaA;;;;;gCACT,IArCaD,AAqCTA,sBAAsBE,QAAQ,EAC9B;;;gCAtCSF,sBAuCSE,QAAQ,GAAG;gCAEjC,qBAAqB;gCACrB;;oCA1CaF,sBA0CeG,WAAW;;;gCAAvC;gCAEA,8BAA8B;gCA5CjBH,sBA6CSI,iBAAiB;gCA7C1BJ,sBA8CSK,qBAAqB;gCA9C9BL,sBA+CSM,iBAAiB;;;;;;gBAC3C;;;;YAGaH,KAAAA;mBADb,AACA,uCADuC;YACvC,SAAaA;;wBAAYI,QAAkEC;;;;;gCAAlED,SAAAA,oEAnDRP,AAmDiBA,sBAAsBS,YAAY,CAACC,oBAAoB,EAAEF,UAAAA,oEAnD1ER,AAmDoFA,sBAAsBS,YAAY,CAACE,iBAAiB;gCACrJ,IAAI,CAAE,CAAA,YAAYC,MAAK,GACnB;;;oCACSC,QAAQC,GAAG;gCAAE;;oCAAMC,OAAOC,IAAI;;;gCAApC;;oCAAMH,QAAAA;wCAAa,cACrBI,MAAM,CAACtB,SAAAA;mDAAOA,IAAIuB,UAAU,CAACX;2CAC7BU,MAAM,CAACtB,SAAAA;mDAAOA,QAAQa;2CACtB7B,GAAG,CAACgB,SAAAA;mDAAOoB,OAAOI,MAAM,CAACxB;;;;;gCAH9B;;oCAAO;;;;gBAIX;;;;YAGayB,KAAAA;mBADb,AACA,qCADqC;YACrC,SAAaA;;wBAAWZ;;;;;gCAAAA,UAAAA,oEA7DPR,AA6DiBA,sBAAsBS,YAAY,CAACE,iBAAiB;gCAClF,IAAI,CAAE,CAAA,YAAYC,MAAK,GAAI;oCACvBS,QAAQC,IAAI,CAAC;oCACb;;;gCACJ;oCAGaT,QAAQC,GAAG;gCAAE;;oCAAMC,OAAOC,IAAI;;;gCAApC;;oCAAMH,QAAAA;wCAAa,cACrBI,MAAM,CAACtB,SAAAA;mDAAOA,IAAIuB,UAAU,CAACV;2CAC7B7B,GAAG,CAACgB,SAAAA;mDAAOoB,OAAOI,MAAM,CAACxB;;;;;gCAH9B,6CAA6C;gCAC7C;;oCAAO;;;;gBAGX;;;;YAGO4B,KAAAA;mBADP,AACA,8BAD8B;YAC9B,SAAOA,OAAOC,OAAO;gBACjBlD,OAAOmD,MAAM,CA3EAzB,AA2ECA,sBAAsBS,YAAY,EAAEe;YACtD;;;YAGOpB,KAAAA;mBADP,AACA,oCADoC;YACpC,SAAOA;oBAAkBsB,OAAAA,iEA/ER1B,AA+EeA,sBAAsBS,YAAY,CAACkB,oBAAoB;gBACnF,IAAI,CAACC,eAAeC,GAAG,CAACH,OACpBE,eAAeE,MAAM,CAACJ,MAAMK;YACpC;;;YAGO1B,KAAAA;mBADP,AACA,kCADkC;YAClC,SAAOA;oBAAsBqB,OAAAA,iEArFZ1B,AAqFmBA,sBAAsBS,YAAY,CAACuB,kBAAkB;gBACrF,IAAI,CAACJ,eAAeC,GAAG,CAACH,OACpBE,eAAeE,MAAM,CAACJ,MAAMO;YACpC;;;YAGO3B,KAAAA;mBADP,AACA,yDADyD;YACzD,SAAOA;gBACH4B,SAASC,gBAAgB,CAAC,2BAA2BrC,OAAO,CAACsC,SAAAA;oBACzD,IAAMC,UAAUD,IAAIE,YAAY,CAAC;oBACjC,IAAI,CAACD,SACD;oBAEJ,oCAAoC;oBACpC,IAAId;oBACJ,IAAI;wBACAA,SAAS;4BACLgB,YAAYjE,OAAOkE,WAAW,CAAClE,OAAOI,OAAO,CAACU,KAAKqD,KAAK,CAACL,IAAIE,YAAY,CAAC,gBAAgB,OAAO3D,GAAG,CAAC;yEAAEgB,iBAAK+C;uCAAS;oCACjH/C;oCACC,CAAA,OAAO+C,oCAAP,SAAOA,IAAE,MAAM,YAAYA,IAAIC,IAAI,GAAI,wCACjCD;wCACHC,MAAM1E,OAAO,CAACyE,IAAIC,IAAI,CAAC,IAAIzE;yCAC1BD,OAAO,CAACyE,IAAI,IAAIxE;iCACxB;;wBACL;oBACJ,EAAE,OAAO0E,GAAG;wBACRvB,QAAQC,IAAI,CAAC,AAAC,wCAA+C,OAARe,SAAQ,MAAIO;oBACrE;oBAEA,uBAAuB;oBAjHd5C,sBAkHa8B,MAAM,CAACO,SAASD,KAAKb,UAAU,CAAC;gBAC1D;YACJ;;;YAGOsB,KAAAA;mBADP,AACA,+BAD+B;YAC/B,SAAOA;gBACHxB,QAAQC,IAAI,CAAC;YACjB;;;YAGawB,KAAAA;mBADb,AACA,gEADgE;YAChE,SAAaA,SAAST,OAAO;;wBACnBd;;;;gCAAAA,SA7HOvB,AA6HEA,sBAAsB+C,SAAS,CAAClB,GAAG,CAACQ;gCACnD,IAAI,CAACd,QAAQ;oCACTF,QAAQC,IAAI,CAAC,AAAC,0BAAiC,OAARe,SAAQ;oCAC/C;;;gCACJ;gCACO;;oCAlIMrC,sBAkIsBgD,YAAY,CAACzB,OAAO0B,MAAM,EAAE1B,OAAO2B,QAAQ;;;gCAA9E;;oCAAO;;;;gBACX;;;;YAGaF,KAAAA;mBADb,AACA,oDADoD;YACpD,SAAaA,aAAaC,MAAM,EAAEC,QAAQ;;wBAK5BC,IASJC,UACFC,KAGAC,QAOUC,OAEIC,mBASZC,KAQQC,OACFC;;;;gCA5CZ,4CAA4C;gCAC5C,IAAIV,AAAM,YAANA,QAAkBW,sBAAqB;oCACvC;;wCAAOX,OAAOY,OAAO;;gCACzB,OAAO,IAAI,OAAOZ,WAAW,YAAYA,OAAO/B,UAAU,CAAC,MAAM;oCACvDiC,KAAKjB,SAAS4B,aAAa,CAACb;oCAClC,IAAI,CAACE,IACD;;wCAAOtC,QAAQkD,MAAM,CAAC,IAAIC,MAAM,AAAC,gBAAsB,OAAPf,QAAO;;oCAC3D,IAAI,CAAEE,AAAE,YAAFA,IAAcS,sBAChB;;wCAAO/C,QAAQkD,MAAM,CAAC,IAAIC,MAAM,AAAC,OAAa,OAAPf,QAAO;;oCAClD;;wCAAOE,GAAGU,OAAO;;gCACrB;gCAEA,kBAAkB;gCACZT,WAAWF,SAASe,cAAc,IAAI,YAAYrD,QACpDyC,MAAM;qCAIND,UAAAA;;;;;;;;;;;;gCAGa;;oCAAMrC,OAAOmD,IAAI,CAAChB,SAASvC,iBAAiB;;;gCADrD,aAAa;gCACb2C,SAAS;gCAGK;;oCAAMA,OAAOC,KAAK,CAACN;;;gCAA3BM,QAAQ;sCACVA,kBAAAA,4BAAAA,MAAOY,EAAE;;;;gCACHX,YAAYrF,OAAOoF,MAAMI,OAAO,CAAC9B,GAAG,CAACwB;gCAC3C,IAAI,CAAClF,OAAOiG,KAAK,CAACZ,cAAc,AAACa,KAAKC,GAAG,KAAKd,YAAaN,SAASqB,oBAAoB,EACpF;;oCAAOhB,MAAMiB,IAAI;;gCACrB;;oCAAMlB,OAAOnC,MAAM,CAAC+B,SAASvC,iBAAiB;;;gCAA9C;;;;;;;;;;;;;;gCAMA;;oCAAM8D,MAAMxB,QAAQ;wCAAEyB,OAAO;oCAAW;;;gCAA9CjB,MAAM;gCACZ,IAAI,CAACA,IAAIU,EAAE,EACP,MAAM,IAAIH,MAAM,AAAC,QAAkB,OAAXP,IAAIkB,MAAM;qCAGlCvB,UAAAA;;;;;;;;;;;;gCAEI,2BAA2B;gCACrBM,QAAQD,IAAIC,KAAK,IACnBC,UAAU,IAAIiB,QAAQlB,MAAMC,OAAO;gCAEvC,8BAA8B;gCAC9BA,QAAQkB,GAAG,CAACxB,KAAKgB,KAAKC,GAAG,GAAGQ,QAAQ;gCAEpC,iBAAiB;gCACjB;;oCAAMxB,OAAOyB,GAAG,CACZ9B,QACA,IAAI+B,SAAStB,MAAMuB,IAAI,EAAE;wCACrBN,QAAQjB,MAAMiB,MAAM;wCACpBO,YAAYxB,MAAMwB,UAAU;wCAC5BvB,SAAAA;oCACJ;;;gCANJ;;;;;;;;;;;;gCAUJ,kFAAkF;gCAClF,IAAIF,IAAIwB,IAAI,IAAI,OAAOE,mBAAmB,aACtC;;oCAAO1B,IAAIwB,IAAI,CAACG,WAAW,CAAC,IAAIC;;;;gCAGxC,qBAAqB;gCACrB;;oCAAO5B,IAAIe,IAAI;;;;gBACnB;;;;YAGO1C,KAAAA;mBADP,AACA,6DAD6D;YAC7D,SAAOA,OAAOO,OAAO,EAAEY,MAAM;oBAAE1B,SAAAA,iEAAS,CAAC;gBACrC,qDAAqD;gBACrD,IAAM2B,WAAW;oBACbX,YAAY,CAAC;oBACb+C,SAAS;oBACTC,OAAO;wBACHC,aAAa,SAAbA,YAAcC;mCAASA;;wBACvBC,YAAY,SAAZA,WAAaC;mCAASA;;oBAC1B;mBArNS3F,AAsNNA,sBAAsBS,YAAY,EAClCc;oBACHqE,aAAa,AACT,qBAzNK5F,AAyNDA,sBAAsBS,YAAY,CAACmF,WAAW,IAAI,EAAE,SACxD,qBAAIrE,OAAOqE,WAAW,IAAI,EAAE;oBAEhCC,iBAAiB,AACb,qBA7NK7F,AA6NDA,sBAAsBS,YAAY,CAACoF,eAAe,IAAI,EAAE,SAC5D,qBAAItE,OAAOsE,eAAe,IAAI,EAAE;oBAEpCC,mBAAmB,AACf,qBAjOK9F,AAiODA,sBAAsBS,YAAY,CAACqF,iBAAiB,IAAI,EAAE,SAC9D,qBAAIvE,OAAOuE,iBAAiB,IAAI,EAAE;oBAEtCC,UAAU,mBACH;wBACCC,SAAS;wBACTC,eAAe;wBACfC,KAAK;wBACLC,SAAS;wBACTC,QAAQ;wBACRC,iBAAiB;wBACjBC,OAAO;wBACPC,cAAc;wBACdC,YAAY;wBACZC,UAAU;oBACd,GAhPKzG,AAiPDA,sBAAsBS,YAAY,CAACsF,QAAQ,IAAI,CAAC,GAChDxE,OAAOwE,QAAQ,IAAI,CAAC;oBAE5BW,eAAe,AACX,qBArPK1G,AAqPDA,sBAAsBS,YAAY,CAACiG,aAAa,IAAI,EAAE,SAC1D,qBAAInF,OAAOmF,aAAa,IAAI,EAAE;oBAElCC,UAAUpF,OAAOoF,QAAQ,IAAI;oBAC7BC,SAASrF,OAAOqF,OAAO,IAAI;oBAC3BC,YAAYtF,OAAOsF,UAAU,IAAI;oBACjCC,iBAAiBvF,OAAOuF,eAAe,IAAI;oBAC3CC,WAAWxF,OAAOwF,SAAS,IAAI;oBAC/BC,SAASzF,OAAOyF,OAAO,IAAI;oBAC3BC,iBAAiB1F,OAAO0F,eAAe,IA9P9BjH,AA8PkCA,sBAAsBS,YAAY,CAACwG,eAAe,IAAI;oBACjGC,eAAe3F,OAAO2F,aAAa,IA/P1BlH,AA+P8BA,sBAAsBS,YAAY,CAACyG,aAAa,IAAI;oBAC3FC,eAAe5F,OAAO4F,aAAa,IAhQ1BnH,AAgQ8BA,sBAAsBS,YAAY,CAAC0G,aAAa,IAAI;oBAC3FC,kBAAkB7F,OAAO6F,gBAAgB,IAjQhCpH,AAiQoCA,sBAAsBS,YAAY,CAAC2G,gBAAgB,IAAI;oBACpGC,kBAAkB9F,OAAO8F,gBAAgB,IAAI,CAAC;;gBAGlD,uCAAuC;gBACvC,IAAMC,gBACF,qBAAG,IAAIC,IAAI,AACP,qBAAGjJ,OAAO0C,IAAI,CAACkC,SAASX,UAAU,UAD3B;oBAEP;oBACA;oBACA;oBACA;oBACA;oBACA;iBACH;gBAGL,8CAA8C;gBAC9C,IAAIiF,gBAAgBvE;gBACpB,IAAI,OAAOA,WAAW,YAAY,CAACA,OAAO/B,UAAU,CAAC,QAAQgC,SAASuE,QAAQ,EAC1ED,gBAAgBtE,SAASuE,QAAQ,GAAGxE;gBAExC,sDAAsD;gBAvRzCjD,sBAwRS+C,SAAS,CAAC8B,GAAG,CAACxC,SAAS;oBAAEY,QAAQuE;oBAAetE,UAAAA;gBAAS;gBAE/E,8CAA8C;gBAC9C,IAAMwE,UAAU,iBAACC;2BAAW;wBACxBC,OAAO,SAAPA,MAAQlG,MAAMmG;mCAAWF,MAAMG,aAAa,CAAC,IAAIC,YAAYrG,MAAM;gCAC/DsG,SAAS;gCACTC,UAAU;gCACVJ,QAAAA;4BACJ;;wBACAK,SAAS,SAATA;mCAAeP,MAAMQ,MAAM;;oBAC/B;;gBAEA,yBAAyB;gBACzB,IAAA,AAAMC,wCAAN;8BAAMA;6BAAAA;gDAAAA;;gCAEE,kBAFFA;wBAIE,mBAAmB;wBACnB,IAAIC,UAAU;4BACVC,OAAO;4BACPC,UAAU;4BACVC,QAAQ;4BACRC,cAAcpE,KAAKC,GAAG;2BACnBoD,gBACAxE,SAASX,UAAU,IAAI,CAAC;wBAG/B,kCAAkC;wBAClC,MAAKmG,YAAY,GAAG;wBACpB,MAAKC,QAAQ,GAAG;wBAChB,MAAKC,kBAAkB,GAAG;wBAC1B,MAAKC,qBAAqB,GAAG;wBAC7B,MAAKC,MAAM,GAAGlI,OAAOmI,MAAM,GAAGnI,OAAOmI,MAAM,CAACC,QAAQ,CAACX,WAAWA;wBAChE,MAAKY,KAAK,GAAG/F,SAASgG,MAAM,GAAG,MAAKC,YAAY,CAAC;4BAAEC,MAAM;wBAAO;wBAChE,MAAKC,SAAS,GAAG;wBACjB,MAAKC,QAAQ,GAAG,AAAC,SAA+C,OAAvCC,KAAKC,MAAM,GAAG1E,QAAQ,CAAC,IAAI2E,KAAK,CAAC,GAAG;wBAC7D,MAAKC,aAAa,GAAG;wBACrB,MAAKC,iBAAiB,GAAGzH,SAAS0H,sBAAsB;wBACxD,MAAKC,UAAU,GAAG;;;kCAzBpBzB;;4BAiCF,iDAAiD;4BACjD0B,KAAAA;mCAAAA,SAAAA,yBAAyBpI,IAAI,EAAEqI,MAAM,EAAEC,MAAM;gCACzC,IAAID,WAAWC,QACX;gCAEJ,8CAA8C;gCAC9C,IAAI;oCAAC;oCAAY;oCAAqB;oCAAmB;iCAAqB,CAACC,QAAQ,CAACvI,OAAO;oCAC3F,IAAI,IAAI,CAACgH,YAAY,EACjB,IAAI,CAACwB,UAAU,CAAC,IAAI,CAAC5H,YAAY,CAAC,eAAeY,SAAS8D,OAAO;gCACzE,OAAO,IAAItF,SAAS,aAChB,IAAI,CAACyI,aAAa,IAAI,oCAAoC;qCAE1D,IAAI,CAACC,WAAW,CAAC1I,MAAMsI;gCAE3B,qBAAqB;gCACrB,IAAI,IAAI,CAACtB,YAAY,EAAE;oCACnB,IAAI,CAAC2B,YAAY,CAAC,WAAW;wCAAE3I,MAAAA;wCAAMqI,QAAAA;wCAAQC,QAAAA;oCAAO;gCACxD;4BACJ;;;4BAEA,0BAA0B;4BAC1BM,KAAAA;mCAAAA,SAAAA;gCACI,IAAI,CAACC,YAAY,CAAC,sBAAsB,IAAI,CAAClI,OAAO;gCAEpD,qEAAqE;gCACrE,2CAA2C;gCAC3C,IAAI,IAAI,CAACuG,kBAAkB,EAAE;oCACzB4B,aAAa,IAAI,CAAC5B,kBAAkB;oCACpC,IAAI,CAACA,kBAAkB,GAAG;oCAC1B,QAAQ,kCAAkC;gCAC9C;gCAEA,yDAAyD;gCACzD,IAAI,IAAI,CAACF,YAAY,EAAE;oCACnB,IAAI,CAAC2B,YAAY,CAAC;oCAClB;gCACJ;gCAEA,+DAA+D;gCAC/D,IAAI,IAAI,CAAC1B,QAAQ,EACb;gCAEJ,qBAAqB;gCACrB,IAAI,CAACA,QAAQ,GAAG;gCAEhB,gDAAgD;gCAChD,IAAI,CAAC8B,kBAAkB;gCAEvB,8BAA8B;gCAC9B,IAAMC,WAAW,IAAI,CAACpI,YAAY,CAAC,cAAcY,SAASoC,OAAO;gCACjE,IAAIoF,aAAa,QACb,IAAI,CAACC,iBAAiB;qCACrB,IAAID,aAAa,QAClB,IAAI,CAACE,eAAe;qCAEpB,IAAI,CAACC,KAAK;gCAEd,wCAAwC;gCACxC,IAAI,CAACV,aAAa;4BACtB;;;4BAEA,4BAA4B;4BAC5BW,KAAAA;mCAAAA,SAAAA;;gCACI,eAAe;gCACf,IAAI,CAACC,YAAY;gCAEjB,uBAAuB;gCACvB,IAAI,IAAI,CAACrB,aAAa,EAAE;oCACpB,IAAI,CAACA,aAAa,CAACsB,UAAU;oCAC7B,IAAI,CAACtB,aAAa,GAAG;gCACzB;gCAEA,+CAA+C;gCAC/C,IAAI,IAAI,CAACuB,YAAY,IAAI,IAAI,CAACC,YAAY,CAAC,eAAe;oCACtD,IAAI,CAACb,YAAY,CAAC;oCAClB;gCACJ;gCAEA,kEAAkE;gCAClE,IAAI,CAACzB,kBAAkB,GAAGuC,WAAW;oCACjC,2DAA2D;oCAC3D,IAAI,MAAKC,WAAW,EAAE;wCAClB,MAAKxC,kBAAkB,GAAG;wCAC1B;oCACJ;oCAEA,iBAAiB;oCACjB,MAAKyB,YAAY,CAAC;oCAElB,6BAA6B;oCAC7B,IAAI,MAAKxB,qBAAqB,EAC1B,MAAKA,qBAAqB,CAACwC,KAAK;oCACpC,IAAI,MAAKhC,SAAS,EACd,MAAKA,SAAS,CAAC2B,UAAU;oCAC7B,IAAI,MAAK/B,KAAK,IAAIrI,OAAOmI,MAAM,IAAI,MAAKL,YAAY,EAChD9H,OAAOmI,MAAM,CAACuC,WAAW,CAAC,MAAKrC,KAAK;oCAExC,yDAAyD;oCACzD,MAAKP,YAAY,GAAG;oCACpB,MAAKC,QAAQ,GAAG;oCAChB,MAAKC,kBAAkB,GAAG;gCAC9B,GAAG;4BACP;;;4BAEA,yCAAyC;4BACzCuB,KAAAA;mCAAAA,SAAAA;;gCACI,IAAI,CAACY,YAAY;gCACjB,IAAMQ,WAAWC,SAAS,IAAI,CAAClJ,YAAY,CAAC,sBAAsBY,SAASiE,aAAa;gCACxF,IAAI/C,MAAMmH,aAAaA,YAAY,GAC/B;gCAEJ,kBAAkB;gCAClB,IAAI,CAAC1B,UAAU,GAAGsB,WAAW;;4CAKnBM;;;;oDAJN,IAAI,CAAC,IAAI,CAACL,WAAW,EACjB;;;oDAEJ,mBAAmB;oDACbK,MAAM,IAAI,CAACnJ,YAAY,CAAC,eAAeY,SAAS8D,OAAO;yDACzDyE,CAAAA,OAAO,IAAI,CAAC/C,YAAY,IAAI,CAAC,IAAI,CAACI,MAAM,CAACP,QAAO,AAAC,GAAjDkD;;;;oDACA;;wDAAM,IAAI,CAACvB,UAAU,CAACuB,KAAK;;;oDAA3B;;;oDAEJ,qBAAqB;oDACrB,IAAI,CAACtB,aAAa;;;;;;oCACtB;mCAAGoB;4BACP;;;4BAEA,mCAAmC;4BACnCR,KAAAA;mCAAAA,SAAAA;gCACI,IAAI,IAAI,CAAClB,UAAU,EAAE;oCACjBW,aAAa,IAAI,CAACX,UAAU;oCAC5B,IAAI,CAACA,UAAU,GAAG;gCACtB;4BACJ;;;4BAEA,wCAAwC;4BACxCc,KAAAA;mCAAAA,SAAAA;;gCACI,IAAMe,cAAcxJ,SAASyJ,aAAa,CAAC;gCAC3CD,YAAYE,KAAK,CAACC,SAAS,GAAG;gCAC9B,IAAI,CAAC5C,KAAK,CAAC6C,WAAW,CAACJ;gCACvB,IAAI,CAACrC,SAAS,GAAG,IAAI0C,qBAAqB,SAACrN;oCACvC,IAAIA,OAAO,CAAC,EAAE,CAACsN,cAAc,EAAE;wCAC3B,MAAKnB,KAAK;wCACV,MAAKxB,SAAS,CAAC2B,UAAU;wCACzB,MAAK3B,SAAS,GAAG,MAAM,8BAA8B;oCACzD;gCACJ,GAAG;oCAAE4C,YAAY;gCAAQ;gCACzB,IAAI,CAAC5C,SAAS,CAAC6C,OAAO,CAAC,IAAI;4BAC/B;;;4BAEA,wBAAwB;4BACxBtB,KAAAA;mCAAAA,SAAAA;;gCACI,IAAI,yBAAyBhK,QAAQ;oCACjCuL,oBAAoB;+CAAM,MAAKtB,KAAK;uCAAI;wCAAEuB,SAAS;oCAAK;gCAC5D,OAAO;oCACHjB,WAAW;+CAAM,MAAKN,KAAK;uCAAI;gCACnC;4BACJ;;;4BAEA,0DAA0D;4BAC1DwB,KAAAA;mCAAAA,SAAAA;;gCACI,IAAI,IAAI,CAAC3C,aAAa,EAClB;gCAEJ,IAAI,CAACA,aAAa,GAAG,IAAI4C,iBAAiB,SAACC;2CAAcA,UAAUzM,OAAO,CAAC0M,SAAAA;wCACvEA,SAASC,UAAU,CAAC3M,OAAO,CAAC4M,SAAAA;4CACxB,sCAAsC;4CACtC,IAAIA,KAAKC,QAAQ,KAAKC,KAAKC,YAAY,IAAIH,KAAKC,QAAQ,KAAKC,KAAKE,SAAS,EACvE;4CAEJ,+DAA+D;4CAC/D,IAAIJ,KAAKC,QAAQ,KAAKC,KAAKC,YAAY,IAAIH,KAAKxB,YAAY,CAAC,kBACzD;4CAEJ,gEAAgE;4CAChE,IAAM6B,WAAW,AAACL,CAAAA,KAAKC,QAAQ,KAAKC,KAAKC,YAAY,GAAGH,KAAKpK,YAAY,CAAC,UAAU,IAAG,KAAM,WACzF0K,YAAY,MAAK/D,KAAK,CAACnF,aAAa,CAAC,AAAC,sBAA8B,OAATiJ,UAAS;4CAExE,mCAAmC;4CACnC,IAAIC,WACAA,UAAUlB,WAAW,CAACY;wCAC9B;oCACJ;;gCAEA,yCAAyC;gCACzC,IAAI,CAAChD,aAAa,CAACwC,OAAO,CAAC,IAAI,EAAE;oCAAEe,WAAW;gCAAK;4BACvD;;;4BAGM9E,KAAAA;mCADN,AACA,qCADqC;4BACrC,SAAMA;;wCAMI+E,gBAMIxI;;;;gDAXV,IAAI,IAAI,CAACiE,QAAQ,EACb;;;gDACJtH,QAAQ8L,GAAG,CAAC,AAAC,oBAA2B,OAAR9K,SAAQ;gDAExC,8CAA8C;gDACxC6K,iBAAiB,IAAI,CAAC5K,YAAY,CAAC,eAAeY,SAAS8D,OAAO;gDACxE,IAAIkG,gBACA3O,eAAe4C,MAAM,CAAC+L;qDAGtBhK,SAASe,cAAc,EAAvBf;;;;gDACc;;oDAAMnC,OAAOmD,IAAI,CAAChB,SAASvC,iBAAiB;;;gDAApD+D,QAAQ;gDACd;;oDAAMA,MAAMvD,MAAM,CAACqG;;;gDAAnB;;;gDAGJ,cAAc;gDACd,IAAI,CAACkB,YAAY,GAAG;gDACpB,IAAI,CAACI,MAAM,CAACP,QAAQ,GAAG;gDACvB,IAAI,CAACO,MAAM,CAACN,MAAM,GAAG;gDACrB,IAAI,CAACM,MAAM,CAACR,KAAK,GAAG;gDAEpB,kBAAkB;gDAClB;;oDAAM,IAAI,CAACuC,KAAK;;;gDAAhB;;;;;;gCACJ;;;;4BAGMA,KAAAA;mCADN,AACA,qBADqB;4BACrB,SAAMA;;+CACIuC,WAUIC,UAOAxJ,SAGFyJ,YA4CCC,KAGCC,uBAuBOC;;;;;gDA1FXL,YAAYM,YAAYpJ,GAAG;;;;;;;;;gDAE7B,qBAAqB;gDACrB,IAAI,IAAI,CAACoE,YAAY,EACjB;;;gDAEJ,mBAAmB;gDACnB,IAAI,CAAC2B,YAAY,CAAC;gDAElB,8DAA8D;gDACxDgD;oDACDnK,SAAS0C,WAAW,CAAC+H,MAAM,IAAIzK,SAAS2C,eAAe,CAAC8H,MAAM,GAAI,IAAI,CAACC,yBAAyB,KAAK/M,QAAQgN,OAAO;oDACrH,IAAI,CAACC,eAAe,CAACtG;oDACpBtE,SAAS8D,OAAO,IAAI,IAAI,CAAC1E,YAAY,CAAC,cAAe,IAAI,CAAC4H,UAAU,CAAC,IAAI,CAAC5H,YAAY,CAAC,eAAeY,SAAS8D,OAAO,IAAInG,QAAQgN,OAAO;;gDAI7H;;oDAAMhN,QAAQC,GAAG,CAACuM;;;gDAA7BxJ,UAAU,AAAC,aAA4B,CAAC,EAAE;gDAEhD,4DAA4D;gDACxDyJ,aAAa;gDACjB,IAAI,CAACpK,SAASgG,MAAM,EAChBoE,aAAa,IAAI,CAACS,kBAAkB;gDAExC,+BAA+B;gDAC/B,IAAI,CAAC9E,KAAK,CAAC+E,eAAe;gDAE1B,sDAAsD;gDACtD,IAAI9K,SAASgG,MAAM,IAAIhG,SAAS0C,WAAW,CAAC+H,MAAM,EAAE;oDAChDzK,SAAS0C,WAAW,CAAC9F,OAAO,CAACmO,SAAAA;wDACzB,IAAMC,OAAOhM,SAASyJ,aAAa,CAAC;wDACpCuC,KAAKC,GAAG,GAAG;wDACXD,KAAKE,IAAI,GAAGH;wDACZ,MAAKhF,KAAK,CAAC6C,WAAW,CAACoC;oDAC3B;gDACJ;gDAEA,wBAAwB;gDACxB;;oDAAM,IAAI,CAACG,WAAW,CAACxK,SAASyJ;;;gDAAhC;gDAEA,sCAAsC;gDACtC,IAAIpK,SAASgG,MAAM,IAAIhG,SAASwD,aAAa,CAACiH,MAAM,GAAG,GACnD,IAAI,CAACW,qBAAqB;gDAE9B,gDAAgD;gDAChD,IAAI,CAACpL,SAASgG,MAAM,EAChB,IAAI,CAACmD,iBAAiB;gDAE1B,oBAAoB;gDACpB;;oDAAM,IAAI,CAACkC,WAAW;;;gDAAtB;gDAEA,+BAA+B;gDAC/B,IAAI,CAACC,KAAK,GAAG;oDAAEC,UAAUf,YAAYpJ,GAAG,KAAK8I;gDAAU;gDAEvD,0BAA0B;gDAC1B,IAAI,CAAC1E,YAAY,GAAG;gDACpB,IAAI,CAACC,QAAQ,GAAG;gDAEhB,yBAAyB;gDACzB,IAAI,CAAC+F,SAAS,CAAC;gDACf,IAAI,CAACrE,YAAY,CAAC;gDAElB,yBAAyB;gDACzB,IAAI,CAACqE,SAAS,CAAC;;;;;;gDACVnB;gDACLlM,QAAQsN,KAAK,CAAC,AAAC,UAAiB,OAARtM,SAAQ,MAAIkL;gDACpC,IAAI,CAAC5E,QAAQ,GAAG,OAAO,kCAAkC;gDACnD6E,iBAAiB,IAAI,CAAClL,YAAY,CAAC,eAAeY,SAASyD,QAAQ;qDACrE6G,gBAAAA;;;;;;;;;;;;gDAEI,qBAAqB;gDACrB,IAAI,CAACvE,KAAK,CAAC+E,eAAe;qDAGpB,KAAA,IAAI,EAACK,WAAW;gDAAC;;oDAAM,IAAI,CAACP,eAAe,CAACN;;;gDADlD,qFAAqF;gDACrF;;oDAAM;wDAAiB;wDAA4C;;;;gDAAnE;gDAEA,+CAA+C;gDAC/C;;oDAAM,IAAI,CAACe,WAAW;;;gDAAtB;gDAEA,+BAA+B;gDAC/B,IAAI,CAACC,KAAK,GAAG;oDAAEC,UAAUf,YAAYpJ,GAAG,KAAK8I;gDAAU;gDAEvD,0BAA0B;gDAC1B,IAAI,CAAC1E,YAAY,GAAG;gDAEpB,0BAA0B;gDAC1B,IAAI,CAACgG,SAAS,CAAC;gDAEf,yCAAyC;gDACzC;;;;gDACKjB;gDACLpM,QAAQsN,KAAK,CAAC,AAAC,UAAiB,OAARtM,SAAQ,uBAAqBoL;gDACrD,uDAAuD;gDACvD,IAAI,CAACmB,YAAY,CAAC,AAAC,gBAA2B,OAAZrB,IAAIsB,OAAO,EAAC;;;;;;;;;;;gDAGlD,yBAAyB;gDACzB,IAAI,CAACD,YAAY,CAACrB,IAAIsB,OAAO;;;;;;;;;;;;;gCAGzC;;;;4BAGM3E,KAAAA;mCADN,AACA,2EAD2E;4BAC3E,SAAMA,WAAW+D,GAAG;oCAAEa,YAAAA,iEAAY;;+CAQxBC,QAQAC,WAsHS9L,iBAlHL+L,cA+CAjO,MACFkO,QAGAC,aAIAC,UAaMC,WAuCJC,MAMFC,eAGQC,UAGC5M,GASRA,IAiBG;;;;;gDApKZ,IAAI,CAACqL,KACD;;;gDAEJ,8DAA8D;gDAC9D,IAAI,IAAI,CAACpF,qBAAqB,EAC1B,IAAI,CAACA,qBAAqB,CAACwC,KAAK;gDACpC,IAAI,CAACxC,qBAAqB,GAAG,IAAI4G;gDAC3BV,SAAS,IAAI,CAAClG,qBAAqB,CAACkG,MAAM;gDAEhD,0DAA0D;gDAC1D,IAAI,CAACjG,MAAM,CAACP,QAAQ,GAAG;gDACvB,IAAI,CAACO,MAAM,CAACN,MAAM,GAAG;gDACrB,IAAI,CAACM,MAAM,CAACR,KAAK,GAAG;gDAEpB,2DAA2D;gDACrD0G,YAAY7D,WAAW;2DAAM,MAAKtC,qBAAqB,CAACwC,KAAK,CAAC;mDAAYnI,SAASkE,gBAAgB;;;;;;;;;gDAGrG,+EAA+E;gDACzE6H,eAAe,sBAAOS,UAAUC;;4DAC9BC,QACEC,SACFC,SASMC,iBAUQC,cAEDpN;;;;oEAvBbgN,SAAS,CAAC;oEACRC,UAAU,IAAI,CAACvN,YAAY,CAACoN,WAC9BI,UAAU;wEACN3M,IAAI,IAAI;wEACR8M,KAAK,IAAI;wEACTC,OAAO,IAAI,CAACpH,MAAM;wEAClBA,QAAQ,IAAI,CAACA,MAAM;wEACnBqH,MAAM,IAAI,CAAClH,KAAK;wEAChBmH,OAAO,IAAI,CAACnH,KAAK;oEACrB;yEACA4G,SAAAA;;;;oEACME,UAAUF,QAAQQ,IAAI;;;;;;;;;oEAExB,sCAAsC;oEACtC,IAAIN,QAAQ7O,UAAU,CAAC,QAAQ6O,QAAQ7O,UAAU,CAAC,MAC9C0O,SAASxQ,KAAKqD,KAAK,CAACsN,QAAQjR,OAAO,CAAC,MAAM;yEACzC,MAAM,IAAIkF;;;;;;;;;;;;;;;oEAGX,mEAAmE;oEACnE,mEAAmE;oEAC7DgM,SAAS,AAAC,IAAIM,SAAS,UAAU,OAAO,AAAC,WAAkB,OAARP,SAAQ,MAAK,IAAI,CAACjH,MAAM,EAAE,IAAI;yEAC9E,CAAA,OAAOkH,WAAW,UAAS,GAA3B;;;;oEAA+B;;wEAAMA,OAAOO,IAAI,CAAC,IAAI,EAAET;;;2EAAxB;;;;;;2EAAmCE;;;oEAA3EJ;;;;;;oEACKhN;oEACLvB,QAAQC,IAAI,CAAC,AAAC,0BAA0Ce,OAAjBqN,UAAS,UAAgB,OAARrN,SAAQ,MAAIO;;;;;;;;;;;yEAM5E+M,WAAAA;;;;;;wEAEOC;;yEAGK,CAAA,OAAOD,cAAc,UAAS,GAA9B;;;;oEACM;;wEAAMA,UAAUY,IAAI,CAAC,IAAI,EAAET;;;4EAA3B;;;;;;4EACAH;;;oEANlBC,SAAS;wEAGD,SAIK,CAAC;;;;oEAIlB;;wEAAOA;;;;oDACX;;gDAGa;;oDAAMX,aAAa,mBAAmB/L,SAASgE,aAAa;;;gDAAnElG,OAAO;gDACA;;oDAAMiO,aAAa,qBAAqB/L,SAAS+D,eAAe;;;gDAAzEiI,SAAS;gDAEb,6DAA6D;gDACzDC,cAAclB;gDAClB3P,OAAOI,OAAO,CAACsC,MAAMlB,OAAO,CAAC;6FAAElB,eAAGC;2DAAOsQ,cAAcA,YAAYrQ,OAAO,CAAC,AAAC,IAAK,OAAFF,IAAKM,WAAWL;;gDAE/F,wDAAwD;gDACpDuQ,WAAW,IAAIoB,IAAIrB,aAAavO,OAAO6P,QAAQ,CAACC,MAAM;gDAC1D,IAAIpS,OAAO0C,IAAI,CAACkO,QAAQvB,MAAM,GAAG,GAC7ByB,SAASuB,MAAM,GAAGrR,mBAAmB4P,QAAQpK,QAAQ;gDAEzD,gCAAgC;gDAChCsK,WAAWA,SAAStK,QAAQ;gDAE5B,mCAAmC;gDACnC,IAAIgK,WACAvQ,eAAe4C,MAAM,CAACiO;gDAE1B,2DAA2D;gDAC3D,IAAI,CAAC7Q,eAAeqS,GAAG,CAACxB,WAAW;oDACzBC,YAAY,AAAC;;gEAIRrP,qCAKIkD,iBARP1B,SAUUgO,UAGD5M,GAMPa,KAKAoN;;;;wEAxBFrP,UAAU;4EACVsP,QAAQ;4EACRnN,SAAS;gFAAE,UAAU;4EAAmB;2EACrC3D,EAAAA,sCAjuBdA,AAiuBcA,sBAAsBS,YAAY,cAAlCT,0DAAAA,oCAAoCqH,gBAAgB,KAAI,CAAC,GACzDnE,CAAAA,qBAAAA,+BAAAA,SAAUmE,gBAAgB,KAAI,CAAC;6EAIlC,CAAA,QAAOnE,qBAAAA,gCAAAA,kBAAAA,SAAUqC,KAAK,cAAfrC,sCAAAA,gBAAiBsC,WAAW,MAAK,UAAS,GAAjD;;;;;;;;;;;;wEAEqB;;4EAAMtC,SAASqC,KAAK,CAACC,WAAW,CAAChE;;;wEAA5CgO,WAAW;wEACjB,IAAIA,YAAY,CAAA,OAAOA,yCAAP,SAAOA,SAAO,MAAM,UAChChO,UAAUgO;;;;;;wEACT5M;wEACLvB,QAAQC,IAAI,CAAC,AAAC,qCAA4C,OAARe,SAAQ,MAAIO;;;;;;wEAK1D;;4EAAM6B,MAAM2K,UAAU5N;;;wEAA5BiC,MAAM;wEACZ,IAAI,CAACA,IAAIU,EAAE,EACP,MAAM,IAAIH,MAAM,AAAC,cAAwB,OAAXP,IAAIkB,MAAM;wEAE5C,uCAAuC;wEACjCkM,cAAcpN,IAAIE,OAAO,CAAC9B,GAAG,CAAC;wEACpC,IAAI,EAACgP,wBAAAA,kCAAAA,YAAa5G,QAAQ,CAAC,sBACvB,MAAM,IAAIjG,MAAM;wEAGb;;4EAAMP,IAAI6L,IAAI;;;wEADrB,sBAAsB;wEACtB;;4EAAO;;;;wDACX;;oDAEA,sDAAsD;oDACtD/Q,eAAesG,GAAG,CAACuK,UAAUC;oDAC7BA,UAAU0B,KAAK,CAAC;+DAAMxS,eAAe4C,MAAM,CAACiO;;gDAChD;gDAGa;;oDAAMvO,QAAQmQ,IAAI;wDAC3BzS,eAAesD,GAAG,CAACuN;wDACnB,IAAIvO,QAAQ,SAACoQ,GAAGlN;mEAAWgL,OAAOmC,gBAAgB,CAAC,SAAS;uEAAMnN,OAAO,IAAIC,MAAM;+DAAa;gEAAEmN,MAAM;4DAAK;;;;;gDAF3G7B,OAAO;gDAKb,8CAA8C;gDAC1CC,gBAAgBD;qDAChB,CAAA,QAAOpM,qBAAAA,gCAAAA,kBAAAA,SAAUqC,KAAK,cAAfrC,sCAAAA,gBAAiBwC,UAAU,MAAK,UAAS,GAAhD;;;;;;;;;;;;gDAEmB;;oDAAMxC,SAASqC,KAAK,CAACG,UAAU,CAAC4J;;;gDAA3CE,WAAW;gDACf,IAAIA,YAAY,CAAA,OAAOA,yCAAP,SAAOA,SAAO,MAAM,UAChCD,gBAAgBC;;;;;;gDACf5M;gDACLvB,QAAQC,IAAI,CAAC,AAAC,oCAA2C,OAARe,SAAQ,MAAIO;;;;;;gDAIrE,wDAAwD;gDACxD,IAAI,CAACmM,OAAOqC,OAAO,EACf,IAAI,CAACtI,MAAM,CAACR,KAAK,GAAGiH;;;;;;gDAEnB3M;gDACL,mEAAmE;gDACnE,IAAImM,OAAOqC,OAAO,EAAE;oDAChB,IAAIrC,OAAOsC,MAAM,KAAK,WAAW;wDAC7B,IAAI,CAACvI,MAAM,CAACN,MAAM,GAAG,AAAC,2BAAgD,OAAtBtF,SAASoO,YAAY,EAAC;wDACtE,IAAI,CAACxI,MAAM,CAACR,KAAK,GAAG;oDACxB;oDACA;;;gDACJ;gDACAjH,QAAQsN,KAAK,CAAC,AAAC,0BAA6B,OAAJV,MAAOrL;gDAC/C,IAAI,CAACkG,MAAM,CAACN,MAAM,GAAG5F,GAAEiM,OAAO;gDAC9B,IAAI,CAAC/F,MAAM,CAACR,KAAK,GAAG;;;;;;gDAEpB,qDAAqD;gDACrDkC,aAAawE;gDACb,IAAI,CAACD,OAAOqC,OAAO,IAAIrC,OAAOsC,MAAM,KAAK,WAAW;;oDAChD,IAAI,CAACvI,MAAM,CAACP,QAAQ,GAAG;oDACvB,IAAI,EAAA,8BAAA,IAAI,CAACM,qBAAqB,cAA1B,kDAAA,4BAA4BkG,MAAM,MAAKA,QACvC,IAAI,CAAClG,qBAAqB,GAAG;gDACrC;;;;;;;;;;gCAER;;;;4BAEA,0BAA0B;4BAC1BwB,KAAAA;mCAAAA,SAAAA,aAAakH,QAAQ;oCAAE1J,SAAAA,iEAAS,CAAC;gCAC7B,IAAI3E,SAASqC,KAAK,IAAI,OAAOrC,SAASqC,KAAK,CAACgM,SAAS,KAAK,YAAY;oCAClErO,SAASqC,KAAK,CAACgM,SAAS,CAAChB,IAAI,CAAC,IAAI,EAAE;wCAChCpN,IAAI,IAAI;wCACRgN,MAAM,IAAI,CAAClH,KAAK;wCAChBiH,OAAO,IAAI,CAACpH,MAAM;uCACfjB;gCAEX;4BACJ;;;4BAGM+F,KAAAA;mCADN,AACA,oCADoC;4BACpC,SAAMA;;wCACIP;;;;gDAAAA;gDAEN,sCAAsC;gDACtC,iEAAiE;gDACjEnK,SAAS0C,WAAW,CAAC9F,OAAO,CAACmO,SAAAA;oDACzB,+BAA+B;oDAC/B,IAAI,CAAC/L,SAAS4B,aAAa,CAAC,AAAC,cAAiB,OAAJmK,KAAI,QAAM;wDAChD,IAAMC,OAAOhM,SAASyJ,aAAa,CAAC;wDACpCuC,KAAKC,GAAG,GAAG;wDACXD,KAAKE,IAAI,GAAGH;wDACZ/L,SAASsP,IAAI,CAAC1F,WAAW,CAACoC;oDAC9B;gDACJ;gDAEA,6CAA6C;gDAC7C,uDAAuD;gDACvDhL,SAAS2C,eAAe,CAAC/F,OAAO,CAACmO,SAAAA;oDAC7B,IAAI,CAACjQ,gBAAgB4S,GAAG,CAAC3C,MAAM;wDAC3B,IAAMwD,IAAI,IAAI5Q,QAAQ,SAACgN,SAAS9J;4DAC5B,IAAI7B,SAAS4B,aAAa,CAAC,AAAC,eAAkB,OAAJmK,KAAI,QAAM;gEAChDJ;gEACA;4DACJ;4DACA,IAAM6D,SAASxP,SAASyJ,aAAa,CAAC;4DACtC+F,OAAOjG,GAAG,GAAGwC;4DACbyD,OAAOC,KAAK,GAAG;4DACfD,OAAOE,MAAM,GAAG;uEAAM/D;;4DACtB6D,OAAOG,OAAO,GAAG;uEAAM9N,OAAO,IAAIC,MAAM,AAAC,0BAA6B,OAAJiK;;4DAClE/L,SAASsP,IAAI,CAAC1F,WAAW,CAAC4F;wDAC9B;wDACA1T,gBAAgB6G,GAAG,CAACoJ,KAAKwD;oDAC7B;oDACApE,SAASyE,IAAI,CAAC9T,gBAAgB6D,GAAG,CAACoM;gDACtC;gDAEA,wBAAwB;gDACxB;;oDAAMpN,QAAQC,GAAG,CAACuM;;;gDAAlB;;;;;;gCACJ;;;;4BAEA,qCAAqC;4BACrCU,KAAAA;mCAAAA,SAAAA;;gCACI,uDAAuD;gCACvD,IAAI,IAAI,CAACrF,YAAY,EACjB,IAAI,CAACO,KAAK,CAAC9G,gBAAgB,CAAC,mBAAmBrC,OAAO,CAACkN,SAAAA;oCACnD,MAAOA,UAAU+E,UAAU,CACvB,MAAKpI,iBAAiB,CAACmC,WAAW,CAACkB,UAAU+E,UAAU;gCAC/D;gCAEJ,oEAAoE;gCACpE,MAAO,IAAI,CAACA,UAAU,CAClB,IAAI,CAACpI,iBAAiB,CAACmC,WAAW,CAAC,IAAI,CAACiG,UAAU;gCAEtD,mEAAmE;gCACnE,8EAA8E;gCAC9E,OAAO1T,MAAM2T,IAAI,CAAC,IAAI,CAACrI,iBAAiB,CAACsI,UAAU,EAAEC,MAAM,CAAC,SAACC,OAAOzF;oCAChE,sBAAsB;oCACtB,IAAMhL,OAAO,AACTgL,KAAKC,QAAQ,KAAKC,KAAKC,YAAY,IAAIH,KAAKxB,YAAY,CAAC,UACzDwB,KAAKpK,YAAY,CAAC,UAAU;oCAEhC,mBAAmB;oCACnB,OAAO,wCACA6P,QACH,qBAACzQ,MAAO,AAACyQ,CAAAA,KAAK,CAACzQ,KAAK,IAAI,EAAC,AAAC,EAAE0Q,MAAM,CAAC1F;gCAE3C,GAAG;oCAAE2F,SAAS,EAAE;gCAAC;4BACrB;;;4BAGMhE,KAAAA;mCADN,AACA,sCADsC;4BACtC,SAAMA,YAAYxK,OAAO,EAAEyJ,UAAU;;+CAC7BgF,UAIMC,QACFC,SACAC,aAEwB,MAAhBC,MAAM9S,OAaZ+S,KAeAC,QAIIC,aACFC,OA+CNC,SA6CIrG;;;;;qDAlIN7I,AAAO,YAAPA,SAAmBsB,iBAAnBtB;;;;gDACM0O,SAAS1O,QAAQmP,SAAS,IAC5BR,UAAU,IAAIS,eACdR;;;qDACG;;;;gDACqB;;oDAAMF,OAAOW,IAAI;;;gDAAjB,OAAA,eAAhBR,OAAgB,KAAhBA,MAAM9S,QAAU,KAAVA;gDACd,IAAI8S,MACA;;;;gDACJD,YAAYX,IAAI,CAAC,OAAOlS,UAAU,WAAWA,QAAQ4S,QAAQW,MAAM,CAACvT,OAAO;oDAAEwT,QAAQ;gDAAK;;;;;;gDAE9FvP,UAAU4O,YAAYxT,IAAI,CAAC,MAAMuT,QAAQW,MAAM;gDAE/C9R,QAAQ8L,GAAG,CAAC;;;gDAGhB,0DAA0D;gDAC1D,IAAI,OAAOtJ,YAAY,UAAU;oDAC7B,oBAAoB;oDACd8O,MAAM,AAAC,IAAIU,YAAaC,eAAe,CAACzP,SAAS;oDAEvD,4CAA4C;oDAC5CyO,WAAWpQ,SAAS0H,sBAAsB;oDAE1C,uEAAuE;oDAEnE,qBAAGvL,MAAM2T,IAAI,CAACW,IAAInB,IAAI,CAACS,UAAU,UACjC,qBAAG5T,MAAM2T,IAAI,CAACW,IAAI1N,IAAI,CAACgN,UAAU,IACnCnS,OAAO,CAAC4M,SAAAA;+DAAQ4F,SAASxG,WAAW,CAACY;;gDAC3C,OACI4F,WAAWzO,QAAQ0P,SAAS,CAAC;gDAEjC,wDAAwD;gDACxD,IAAI,CAACrQ,SAASsQ,WAAW,EAAE;oDACjBZ,SAASvU,MAAM2T,IAAI,CAACM,SAASnQ,gBAAgB,CAAC;oDAEpD,8CAA8C;oDAC9C,IAAIe,SAASgG,MAAM,IAAIhG,SAASuQ,sBAAsB,IAAIvR,SAASwR,kBAAkB,EAAE;wDAC7Eb,cAAcD,OAAOjU,GAAG,CAACgV,SAAAA;mEAAKA,EAAEC,WAAW;2DAAE3U,IAAI,CAAC;wDACpD6T,QAAQ;wDAEZ,IAAID,YAAYxC,IAAI,GAAG1C,MAAM,GAAG,GAAG;4DAC/B,IAAI7P,gBAAgB8S,GAAG,CAACiC,cACpBC,QAAQhV,gBAAgB+D,GAAG,CAACgR;iEAC3B;gEACDC,QAAQ,IAAIe;gEACZf,MAAMgB,WAAW,CAACjB;gEAClB/U,gBAAgB+G,GAAG,CAACgO,aAAaC;4DACrC;wDACJ;wDAEA,iCAAiC;wDACjC,IAAI,CAAC7J,KAAK,CAACyK,kBAAkB,GAAG,AAC5B,qBAAIxQ,SAAS4C,iBAAiB,eAC9B,qBAAIgN;4DAASA;;wDAGjB,8DAA8D;wDAC9DF,OAAO9S,OAAO,CAACqD,SAAAA;mEAAMA,GAAG4Q,MAAM;;oDAClC,OAAO;wDACH,6CAA6C;wDAC7CnB,OAAO9S,OAAO,CAAC8L,SAAAA;4DACX,IAAI,CAAC1I,SAASgG,MAAM,EAAE;gEAClB,wBAAwB;gEACxB,IAAI,kBAAkBtI,QAAQ;oEAC1BgL,MAAMgI,WAAW,GAAG,AAAC,YAAyD,OAA9ChI,MAAMgI,WAAW,CAAC9U,OAAO,CAAC,UAAU,WAAU;gEAClF,OAAO;oEACH,MAAKyL,YAAY,CAAC,cAAc,MAAKjB,QAAQ;oEAE7C,uDAAuD;oEACvD,uCAAuC;oEACvC,IAAM0K,gBAAgB,AAAC,GAAyB,OAAvB3R,SAAQ,iBAA6B,OAAd,MAAKiH,QAAQ,EAAC;oEAC9D,IAAIsC,MAAMgI,WAAW,CAAC3J,QAAQ,CAAC,UAAU;wEACrC2B,MAAMgI,WAAW,GAAGhI,MAAMgI,WAAW,CAChC9U,OAAO,CAAC,wBAAwB,AAAC,GAAgB,OAAdkV,eAAc,OAAK,oBAAoB;yEAC1ElV,OAAO,CAAC,UAAUkV,gBAAoC,eAAe;oEAC9E;gEACJ;4DACJ;wDACJ;oDACJ;gDACJ,OAAO;oDACH1B,SAASnQ,gBAAgB,CAAC,SAASrC,OAAO,CAACqD,SAAAA;+DAAMA,GAAG4Q,MAAM;;gDAC9D;gDAEA,mDAAmD;gDAC7ChB;gDACN,IAAI7P,SAAS+Q,cAAc,EAAE;oDACzB3B,SAASnQ,gBAAgB,CAAC,UAAUrC,OAAO,CAACoU,SAAAA;wDACxC,IAAMC,YAAYjS,SAASyJ,aAAa,CAAC;wDACzCtN,MAAM2T,IAAI,CAACkC,UAAU3R,UAAU,EAAEzC,OAAO,CAACsU,SAAAA;mEACrCD,UAAU5J,YAAY,CAAC6J,KAAK1S,IAAI,EAAE0S,KAAKxU,KAAK;;wDAEhDuU,UAAUP,WAAW,GAAGM,UAAUN,WAAW;wDAC7Cb,QAAQjB,IAAI,CAACqC;wDACbD,UAAUH,MAAM;oDACpB;gDACJ,OAAO;oDACHzB,SAASnQ,gBAAgB,CAAC,UAAUrC,OAAO,CAACqD,SAAAA;+DAAMA,GAAG4Q,MAAM;;gDAC/D;gDAEA,mCAAmC;gDACnC,IAAI,CAAC7Q,SAASgG,MAAM,EAAE;oDAClB,oFAAoF;oDACpF,0EAA0E;oDAC1EoJ,SAASnQ,gBAAgB,CAAC,QAAQrC,OAAO,CAACuU,SAAAA;wDACtC,IAAM3S,OAAO2S,OAAO/R,YAAY,CAAC,WAAW;wDAE5C,kDAAkD;wDAClD,IAAMgS,SAASpS,SAASyJ,aAAa,CAAC;wDACtC2I,OAAO1I,KAAK,CAAC5F,OAAO,GAAG;wDACvBsO,OAAO/J,YAAY,CAAC,iBAAiB7I;wDAErC,6CAA6C;wDAC7C,IAAM6S,gBAAgBjH,aAAaA,UAAU,CAAC5L,KAAK,GAAG;wDACtD,IAAI6S,iBAAiBA,cAAc5G,MAAM,GAAG,GAAG;4DAC3C4G,cAAczU,OAAO,CAAC4M,SAAAA;uEAAQ4H,OAAOxI,WAAW,CAACY;;wDACrD,OAEK,IAAI2H,OAAOpC,UAAU,CAACtE,MAAM,GAAG,GAAG;4DACnC,MAAO0G,OAAOtC,UAAU,CACpBuC,OAAOxI,WAAW,CAACuI,OAAOtC,UAAU;wDAC5C;wDAEA,yCAAyC;wDACzCsC,OAAOG,WAAW,CAACF;oDACvB;gDACJ;gDAEA,+BAA+B;gDAC/B,MAAOhC,SAASP,UAAU,CAAE;oDAClBrF,OAAO4F,SAASP,UAAU;oDAEhC,mCAAmC;oDACnC,IAAIrF,KAAKC,QAAQ,KAAK,GAClBD,KAAK5D,MAAM,GAAG,IAAI,CAACA,MAAM;oDAE7B,iBAAiB;oDACjB,IAAI,CAACG,KAAK,CAAC6C,WAAW,CAACY;gDAC3B;gDAEA,sCAAsC;gDACtCqG,QAAQjT,OAAO,CAAC6T,SAAAA;2DAAK,MAAK1K,KAAK,CAAC6C,WAAW,CAAC6H;;;;;;;gCAChD;;;;4BAEA,4CAA4C;4BAC5CrF,KAAAA;mCAAAA,SAAAA;;gCACIpL,SAASwD,aAAa,CAAC5G,OAAO,CAAC2U,SAAAA;oCAC3B,MAAKxL,KAAK,CAACiI,gBAAgB,CAACuD,WAAW,SAAC7R;wCACpC,MAAKkF,aAAa,CAAC,IAAIC,YAAY0M,WAAW;4CAC1CzM,SAAS;4CACTC,UAAU;4CACVJ,QAAQjF,EAAEiF,MAAM;wCACpB;oCACJ;gCACJ;4BACJ;;;4BAEA,4CAA4C;4BAC5CuC,KAAAA;mCAAAA,SAAAA,YAAY1I,IAAI,EAAE9B,KAAK;gCACnB,yCAAyC;gCACzC,IAAI8B,SAAS,YACT;gCAEJ,aAAa;gCACb,IAAMgT,YAAYxR,SAASX,UAAU,CAACb,KAAK;gCAE3C,wDAAwD;gCACxD,IAAMiB,OAAO,AAAC+R,aAAaA,UAAU/R,IAAI,GAAI+R,UAAU/R,IAAI,GAAG+R,WAC1DC,WAAW,AAACD,CAAAA,aAAaA,UAAUC,QAAO,AAAC,MAAM,MACjDC,YAAY,AAACF,aAAaA,UAAUE,SAAS,GAAIF,UAAUE,SAAS,GAAG,MACvEC,eAAe,AAACH,aAAaA,UAAUI,cAAc,CAAC,aAAcJ,UAAUrC,OAAO,GAAG0C,WACxFvT,UAAU,AAACkT,aAAaA,UAAUlT,OAAO,GAAIkT,UAAUlT,OAAO,GAAG,MACjEwT,SAAS,AAACN,aAAaA,UAAUM,MAAM,GAAIN,UAAUM,MAAM,GAAG;gCAElE,+BAA+B;gCAC/B,IAAIpV,UAAU,QAAQA,UAAUmV,WAAW;oCACvC,IAAIF,iBAAiBE,WAAW;wCAC5B,IAAI,CAACjM,MAAM,CAACpH,KAAK,GAAGmT;wCACpB;oCACJ;oCACA,IAAIF,UACAtT,QAAQC,IAAI,CAAC,AAAC,gCAA4Ce,OAAbX,MAAK,UAAgB,OAARW,SAAQ;oCAEtE,IAAI,CAAC4S,iBAAiB,CAACvT,MAAMiB;oCAC7B;gCACJ;gCAEA,eAAe;gCACf,IAAIuS;gCACJ,IAAIvS,SAASvE,SAAS;oCAClB8W,cAAetV,UAAU,QAAQA,UAAU;gCAC/C,OAAO,IAAI+C,SAASxE,QAAQ;oCACxB,IAAMgX,MAAMhX,OAAOyB;oCACnBsV,cAAc9Q,MAAM+Q,OAAO,IAAIA;gCACnC,OAAO,IAAIxS,SAASrE,UAAUqE,SAAStE,OAAO;oCAC1C,IAAI;wCACA,IAAI,CAACuB,OAAOsV,cAAc,AAACvS,SAAStE,QAAS,EAAE,GAAG,CAAC;6CAC9C6W,cAAc9V,KAAKqD,KAAK,CAAC7C,MAAMd,OAAO,CAAC,MAAM;oCACtD,EAAE,OAAO8D,GAAG;wCACRvB,QAAQC,IAAI,CAAC,AAAC,oBAAwB,OAALI,MAAK,uBAAqB9B;wCAC3DsV,cAAc,AAACvS,SAAStE,QAAS,EAAE,GAAG,CAAC;oCAC3C;gCACJ,OAAO;oCACH6W,cAActV;gCAClB;gCAEA,4CAA4C;gCAC5C,IAAI4B,WAAWnD,MAAMwB,OAAO,CAAC2B,YAAY,CAACA,QAAQyI,QAAQ,CAACiL,cAAc;oCACrE7T,QAAQC,IAAI,CAAC,AAAC,gBAA+DI,OAAhDwT,aAAY,sCAAiD7S,OAAbX,MAAK,UAAgB,OAARW,SAAQ,gBAAcb;oCAChH,IAAIqT,iBAAiBE,WACjB,IAAI,CAACjM,MAAM,CAACpH,KAAK,GAAGmT;yCACnB,IAAI,IAAI,CAAC/L,MAAM,CAACpH,KAAK,KAAKqT,WAC3B,IAAI,CAACE,iBAAiB,CAACvT,MAAMiB;oCACjC;gCACJ;gCAEA,8BAA8B;gCAC9B,IAAIqS,UAAUrS,SAASrE,UAAU,CAAA,OAAO4W,4CAAP,SAAOA,YAAU,MAAM,YAAYA,gBAAgB,MAAM;oCACtF,IAAI5W,OAAOI,OAAO,CAACsW,QAAQI,IAAI,CAAC;iFAAExW,eAAGyW;wCACjC,IAAM3S,MAAMwS,WAAW,CAACtW,EAAE;wCAC1B,IAAI8D,QAAQqS,WACR,OAAO;wCACX,IAAIM,MAAMnX,QACN,OAAO,OAAOwE,QAAQ;wCAC1B,IAAI2S,MAAMlX,QACN,OAAO,OAAOuE,QAAQ;wCAC1B,IAAI2S,MAAMjX,SACN,OAAO,OAAOsE,QAAQ;wCAC1B,IAAI2S,MAAMhX,OACN,OAAO,CAACA,MAAMwB,OAAO,CAAC6C;wCAC1B,IAAI2S,MAAM/W,QACN,OAAO,CAAA,OAAOoE,oCAAP,SAAOA,IAAE,MAAM,YAAYrE,MAAMwB,OAAO,CAAC6C,QAAQA,QAAQ;wCACpE,OAAO;oCACX,IAAI;wCACArB,QAAQC,IAAI,CAAC,AAAC,4CAAwDe,OAAbX,MAAK,UAAgB,OAARW,SAAQ;wCAC9E,IAAIwS,iBAAiBE,WACjB,IAAI,CAACjM,MAAM,CAACpH,KAAK,GAAGmT;6CACnB,IAAI,IAAI,CAAC/L,MAAM,CAACpH,KAAK,KAAKqT,WAC3B,IAAI,CAACE,iBAAiB,CAACvT,MAAMiB;wCACjC;oCACJ;gCACJ;gCAEA,+BAA+B;gCAC/B,IAAIiS,aAAa,OAAOA,cAAc,YAAY;oCAC9C,IAAI,CAACA,UAAUM,cAAc;wCACzB7T,QAAQC,IAAI,CAAC,AAAC,qCAAiDe,OAAbX,MAAK,UAAgB,OAARW,SAAQ,cAAY6S;wCACnF,+BAA+B;wCAC/B,IAAIL,iBAAiBE,WACjB,IAAI,CAACjM,MAAM,CAACpH,KAAK,GAAGmT;6CAEnB,IAAI,IAAI,CAAC/L,MAAM,CAACpH,KAAK,KAAKqT,WAC3B,IAAI,CAACE,iBAAiB,CAACvT,MAAMiB;wCACjC,0EAA0E;wCAC1E;oCACJ;gCACJ;gCAEA,IAAI,CAACmG,MAAM,CAACpH,KAAK,GAAGwT;4BACxB;;;4BAEA,yBAAyB;4BACzBD,KAAAA;mCAAAA,SAAAA,kBAAkBvT,IAAI,EAAEiB,IAAI;gCACxB,IAAIA,SAASxE,QACT,IAAI,CAAC2K,MAAM,CAACpH,KAAK,GAAG;qCACnB,IAAIiB,SAASvE,SACd,IAAI,CAAC0K,MAAM,CAACpH,KAAK,GAAG;qCACnB,IAAIiB,SAAStE,OACd,IAAI,CAACyK,MAAM,CAACpH,KAAK,GAAG,EAAE;qCACrB,IAAIiB,SAASrE,QACd,IAAI,CAACwK,MAAM,CAACpH,KAAK,GAAG,CAAC;qCACpB,IAAI,CAACoH,MAAM,CAACpH,KAAK,GAAG;4BAC7B;;;4BAEA,iDAAiD;4BACjD+I,KAAAA;mCAAAA,SAAAA;;gCACInD,cAAcxH,OAAO,CAAC4B,SAAAA;2CAAQ,MAAK0I,WAAW,CAAC1I,MAAM,MAAKY,YAAY,CAACZ;;4BAC3E;;;4BAEA,+CAA+C;4BAC/C4T,KAAAA;mCAAAA,SAAAA;;gCACI,IAAMlM,OAAO,IAAI,CAAC9G,YAAY,CAAC,cAAcY,SAAS0D,OAAO;gCAC7D,IAAI,CAACwC,MACD;gCAEJ,iGAAiG;gCACjG,IAAMmM,UAAU,AAACnM,SAAS,UAAWoM,eAAeC,gBAChD9V,MAAM,IAAI,CAAC2C,YAAY,CAAC,kBAAkBY,SAAS2D,UAAU,IACzD,AAAC,OAAwB,OAAlB,IAAI,CAAC6O,SAAS,EAAC,KAAqC,OAAlC,IAAI,CAACC,EAAE,GAAG,MAAM,IAAI,CAACA,EAAE,GAAG,UACvDC,aAAapK,SAAS,IAAI,CAAClJ,YAAY,CAAC,uBAAuBY,SAAS4D,eAAe,IAAI,OAAO;gCAEtG,iCAAiC;gCACjC,IAAI+O,SAAS;gCAEb,0BAA0B;gCAC1B,IAAMC,cAAc;2CAAMxX,OAAOkE,WAAW,CACxClE,OAAOI,OAAO,CAAC,MAAKoK,MAAM,EACrB7H,MAAM,CAAC;iFAAErC,eAAGC;+CAAO,CAACD,EAAEsC,UAAU,CAAC,QAAQ,OAAOrC,MAAM;;;gCAG/D,yBAAyB;gCACzB,IAAMkX,UAAU,iBAACnW;oCACb,IAAIiW,QACArL,aAAaqL;oCACjBA,SAAS;oCACTN,QAAQS,OAAO,CAACrW,KAAKP,KAAKC,SAAS,CAACO,SAASkW;gCACjD;gCAEA,6BAA6B;gCAC7B,IAAI,CAAChN,MAAM,CAACmN,YAAY,GAAG;oCACvBC,MAAMvW;oCACNwW,OAAO,SAAPA,MAAQvW;wCACJ,IAAIgW,aAAa,GAAG;4CAChB,IAAIC,QACArL,aAAaqL;4CACjBA,SAAS1K,WAAW;uDAAM4K,QAAQnW;+CAAQgW;wCAC9C,OAAO;4CACHG,QAAQnW;wCACZ;oCACJ;oCACAwW,QAAQ,SAARA;wCACI,IAAIP,QACArL,aAAaqL;wCACjBA,SAAS;wCACTN,QAAQc,UAAU,CAAC1W;oCACvB;oCACA2W,MAAM,SAANA;4CAAO1X,qEAAI,MAAM+H,4EAAW;wCACxB,IAAI;4CACA,IAAI4P,SAASnX,KAAKqD,KAAK,CAAC8S,QAAQiB,OAAO,CAAC7W;4CACxC,OAAO,AAACf,CAAAA,IAAI2X,MAAM,CAAC3X,EAAE,GAAG2X,MAAK,KAAM5P;wCACvC,EAAE,OAAO/D,GAAG;4CACR,OAAO+D;wCACX;oCACJ;oCACA8P,QAAQ,SAARA;wCACI,IAAIZ,QACAE;oCACR;gCACJ;gCAEA,wBAAwB;gCACxB,IAAI;oCACA,IAAMQ,SAAS,IAAI,CAACzN,MAAM,CAACmN,YAAY,CAACK,IAAI;oCAC5C,IAAIC,UAAU,CAAA,OAAOA,uCAAP,SAAOA,OAAK,MAAM,UAC5B;wCAAA,IAAK,IAAM3X,KAAK,IAAI,CAACkK,MAAM,CACvB,IAAIxK,OAAOoY,SAAS,CAAC5B,cAAc,CAACvE,IAAI,CAACgG,QAAQ3X,IAC7C,IAAI,CAACkK,MAAM,CAAClK,EAAE,GAAG2X,MAAM,CAAC3X,EAAE;oCAAA;gCAC1C,EAAE,OAAOgE,GAAG;oCACRvB,QAAQC,IAAI,CAAC,AAAC,4BAA+B,OAAJ3B,MAAOiD;gCACpD;gCAEA,iCAAiC;gCACjCmG,OAAO4N,MAAM,CAAC;2CAAM,MAAK7N,MAAM,CAACmN,YAAY,CAACE,KAAK,CAACL;;gCAEnD,4CAA4C;gCAC5C,IAAIF,aAAa,GACbhV,OAAOsQ,gBAAgB,CAAC,gBAAgB;2CAAM,MAAKpI,MAAM,CAACmN,YAAY,CAACQ,MAAM;;4BACrF;;;4BAGMlI,KAAAA;mCADN,AACA,6BAD6B;4BAC7B,SAAMA;;;;;wCACF,IAAI3N,OAAOmI,MAAM,EACb;;4CAAO,IAAI,CAAC6N,iBAAiB;;wCAEjC,yDAAyD;wCACzD;;4CAAO,IAAI/V,QAAQ,SAACgN,SAAS9J;gDACzB7B,SAASgP,gBAAgB,CAAC,eAAe;oDACrC,MAAK0F,iBAAiB;oDACtB/I;gDACJ,GAAG;oDAAEsD,MAAM;gDAAK;gDAEhB,UAAU;gDACVhG,WAAW;oDACP,IAAIvK,OAAOmI,MAAM,EAAE;wDACf,MAAK6N,iBAAiB;wDACtB/I;oDACJ,OAEI9J,OAAO,IAAIC,MAAM;gDACzB,GAAG;4CACP;;;gCACJ;;;;4BAEA,kEAAkE;4BAClE4S,KAAAA;mCAAAA,SAAAA;;gCACI,gCAAgC;gCAChC,IAAMC,YAAY,IAAI,CAACvU,YAAY,CAAC,iBAAiBY,SAAS6D,SAAS;gCACvE,IAAI8P,WAAW;oCACX,IAAIC,QAAQ/N,OAAO+N,KAAK,CAACD;oCACzB,IAAIC,OAAO;wCACP,0CAA0C;wCAC1C,IAAI,IAAI,CAAChO,MAAM,IAAI,SAAO,IAAI,CAACA,MAAM,MAAK,UACtCxK,OAAO0C,IAAI,CAAC,IAAI,CAAC8H,MAAM,EAClB7H,MAAM,CAACtB,SAAAA;mDAAOmX,KAAK,CAACnX,IAAI,KAAKoV;2CAC7BjV,OAAO,CAACH,SAAAA;mDAAOmX,KAAK,CAACnX,IAAI,GAAG,MAAKmJ,MAAM,CAACnJ,IAAI;;wCAErD,6BAA6B;wCAC7B,IAAI,CAACmJ,MAAM,GAAGgO;oCAClB,OAAO;wCACHzV,QAAQsN,KAAK,CAAC,AAAC,gBAAyB,OAAVkI,WAAU;wCACxC,IAAI,CAAC/N,MAAM,GAAGlI,OAAOmI,MAAM,CAACC,QAAQ,CAAC,IAAI,CAACF,MAAM,IAAI,CAAC;oCACzD;gCACJ,OAAO;oCACH,0BAA0B;oCAC1B,IAAI,CAACA,MAAM,GAAGlI,OAAOmI,MAAM,CAACC,QAAQ,CAAC,IAAI,CAACF,MAAM,IAAI,CAAC;gCACzD;gCAEA,yBAAyB;gCACzB,IAAI,CAACwM,gBAAgB;gCAErB,0CAA0C;gCAC1C,8EAA8E;gCAC9EvM,OAAO4N,MAAM,CAAC;oCACV,IAAI,MAAK7N,MAAM,EAAE;wCACbxK,OAAO0C,IAAI,CAAC,MAAK8H,MAAM,EAAEhJ,OAAO,CAAClB,SAAAA;4CAC7B,IAAIA,MAAM,gBACN,KAAK,MAAKkK,MAAM,CAAClK,EAAE;wCAC3B;wCACA,MAAKkK,MAAM,CAACL,YAAY,GAAGpE,KAAKC,GAAG;oCACvC;gCACJ;gCAEA,8CAA8C;gCAC9CyE,OAAO+N,KAAK,CAAC,AAAC,SAAmBvN,OAAXlH,SAAQ,KAAuC,OAApCkH,KAAKC,MAAM,GAAG1E,QAAQ,CAAC,IAAI2E,KAAK,CAAC,KAAM,IAAI,CAACX,MAAM;gCAEnF,8CAA8C;gCAC9C,4FAA4F;gCAC5F,IAAI,IAAI,CAACG,KAAK,IAAI,IAAI,CAACA,KAAK,CAAC8N,QAAQ,EACjC1Y,MAAM2T,IAAI,CAAC,IAAI,CAAC/I,KAAK,CAAC8N,QAAQ,EAAEjX,OAAO,CAAC4M,SAAAA;oCACpC,IAAIA,KAAKC,QAAQ,KAAK,GAClBD,KAAK5D,MAAM,GAAG,MAAKA,MAAM;gCACjC;gCAEJ,0EAA0E;gCAC1ElI,OAAOmI,MAAM,CAACiO,QAAQ,CAAC;oCACnB,IAAI,MAAK/N,KAAK,EACVrI,OAAOmI,MAAM,CAACkO,QAAQ,CAAC,MAAKhO,KAAK;gCACzC;4BACJ;;;4BAEA,8BAA8B;4BAC9B2F,KAAAA;mCAAAA,SAAAA,aAAasI,GAAG;gCACZ,IAAMlK,YAAY9K,SAASyJ,aAAa,CAAC;gCACzCqB,UAAUpB,KAAK,CAACuL,OAAO,GAAG3Y,YAAY0E,SAAS6C,QAAQ;gCAEvD,IAAMqR,SAASlV,SAASyJ,aAAa,CAAC;gCACtCyL,OAAOxD,WAAW,GAAG,AAAC,iBAAwB,OAARvR,SAAQ;gCAE9C,IAAMgV,OAAOnV,SAASyJ,aAAa,CAAC;gCACpC0L,KAAKzD,WAAW,GAAGsD;gCACnBG,KAAKzL,KAAK,CAAC5F,OAAO,GAAG;gCACrBqR,KAAKzL,KAAK,CAAC0L,SAAS,GAAG;gCACvBtK,UAAUlB,WAAW,CAACsL;gCACtBpK,UAAUlB,WAAW,CAACuL;gCAEtB,IAAInU,SAASgG,MAAM,EACf,IAAI,CAACD,KAAK,CAAC+E,eAAe,CAAChB;qCAE3B,IAAI,CAAC/D,KAAK,CAAC6C,WAAW,CAACkB;4BAC/B;;;4BAEA,wBAAwB;4BACxB0B,KAAAA;mCAAAA,SAAAA,UAAU+F,SAAS;gCACf,IAAI,CAAC3M,aAAa,CAAC,IAAIC,YAAY0M,WAAW;oCAC1CzM,SAAS;oCACTC,UAAU;oCACVJ,QAAQ;wCAAEqI,OAAO,IAAI,CAACpH,MAAM;oCAAC;gCACjC;4BACJ;;;4BAGMgF,KAAAA;mCADN,AACA,sDADsD;4BACtD,SAAMA,gBAAgB7K,MAAM;;;;;gDACjB;;oDA/1CFjD,sBA+1C8BgD,YAAY,CAACC,QAAQC;;;gDAAxD;;oDAAO;;;;gCACX;;;;4BAIMqU,KAAAA;mCAFN,AAEA,4DAF4D;4BAC5D,qEAAqE;4BACrE,SAAMA;;;;;gDAAuB;;oDAp2CpBvX,sBAo2CgDwX,UAAU,CAACtU,SAASxC,oBAAoB,EAAEwC,SAASvC,iBAAiB;;;gDAAvG;;oDAAO;;;;gCAAmG;;;;4BAC1H8W,KAAAA;mCAAN,SAAMA;;;;;gDAAuB;;oDAr2CpBzX,sBAq2CgDoB,UAAU,CAAC8B,SAASvC,iBAAiB;;;gDAAxE;;oDAAO;;;;gCAAoE;;;;;4BAniCtF+W,KAAAA;iCADX,AACA,6BAD6B;4BAC7B;gCACI,OAAOpQ;4BACX;;;2BA/BEc;qCAAgCuP;gBAmkCtC,0BAA0B;gBAC1B/V,eAAeE,MAAM,CAACO,SAAS+F;YACnC;;;WA12CiBpI;;AACjB,iBADiBA,uBACVE,YAAW;AAClB,iBAFiBF,uBAEV+C,aAAY,IAAIhF;AACvB,iBAHiBiC,uBAGV4X,aAAY;AAEnB,+BAA+B;AAC/B,iBANiB5X,uBAMVS,gBAAe;IAClBoX,OAAO;IACPpQ,UAAU;IACV1B,UAAU,CAAC;IACXmD,QAAQ;IACRuK,wBAAwB;IACxB3N,mBAAmB,EAAE;IACrBmO,gBAAgB;IAChBT,aAAa;IACb9M,eAAe,EAAE;IACjBd,aAAa,EAAE;IACfC,iBAAiB,EAAE;IACnBlE,sBAAsB;IACtBK,oBAAoB;IAEpB,gBAAgB;IAChBiF,iBAAiB;IACjBC,eAAe;IACfC,eAAe;IACfC,kBAAkB;IAElB,mBAAmB;IACnBnD,gBAAgB;IAChB6T,uBAAuB;IACvBpX,sBAAsB;IACtBC,mBAAmB;IACnB4D,sBAAsB,KAAK,KAAK;AACpC;AAjCJ,SAAqBvE,mCA22CpB;AAED,yEAAyE;AACzE,IAAA,AAAM+B,wCAAN;;cAAMA;aAAAA;gCAAAA;QAAN,OAAA,kBAAMA;;kBAAAA;;YACIuI,KAAAA;mBAAN,SAAMA;;wBACImB,KAOFpJ,SAWEd,QAYG,2BAAA,mBAAA,gBAAA,WAAA,OAAM6S,MAQD1R,KAGFqV,cAcNC,aAGD,4BAAA,oBAAA,iBAAA,YAAA,QAAM5D;;wBA1DL3I,MAAM,IAAI,CAACnJ,YAAY,CAAC,UAAU,IAAI,CAACA,YAAY,CAAC;wBAC1D,IAAI,CAACmJ,KAAK;4BACNpK,QAAQsN,KAAK,CAAC,AAAC,IAAkB,OAAf,IAAI,CAAC+G,SAAS,EAAC;4BACjC;;;wBACJ;wBAEA,4CAA4C;wBACxCrT,UAAU,IAAI,CAACC,YAAY,CAAC;wBAChC,IAAI,CAACD,SACDA,UAAU,AAACoJ,IAAIwM,KAAK,CAAC,KAAKC,GAAG,GAAID,KAAK,CAAC,KAAKE,KAAK,IAAI,kBAAkB;wBAE3E,iDAAiD;wBACjD,IAAI,CAAC9V,QAAQ4H,QAAQ,CAAC,MAAM;4BACxB5I,QAAQsN,KAAK,CAAC,AAAC,IAAiCtM,OAA9B,IAAI,CAACqT,SAAS,EAAC,iBAAuB,OAARrT,SAAQ;4BACxD;;;wBACJ;wBAEA,+BAA+B;wBACzBd,SAAS;4BACX2H,QAAQ,IAAI,CAACgC,YAAY,CAAC,YAAa,IAAI,CAAC5I,YAAY,CAAC,cAAc,UAAWtC,sBAAsBS,YAAY,CAACyI,MAAM;4BAC3H5D,SAAS,IAAI,CAAChD,YAAY,CAAC,cAAc;4BACzC0E,SAAS,IAAI,CAAC1E,YAAY,CAAC,eAAe;4BAC1CyE,WAAW,IAAI,CAACzE,YAAY,CAAC,iBAAiB;4BAC9CqE,UAAU,IAAI,CAACrE,YAAY,CAAC,eAAe;4BAC3CC,YAAY,CAAC,EAAE,0BAA0B;wBAC7C;wBAEA,gDAAgD;wBAChD,IAAI,CAACX,eAAeC,GAAG,CAACQ,UAAU;4BAEzB,kCAAA,2BAAA;;gCADL,wDAAwD;gCACxD,IAAK,YAAc,IAAI,CAACE,UAAU,uBAA7B,6BAAA,QAAA,yBAAA,iCAA+B;oCAAzB6R,OAAN;oCACD,IAAI;wCACA;wCAAO;wCAAO;wCAAO;wCAAU;wCAAW;wCAAS;wCAAS;wCAAM;wCAAc;wCAChF;wCAAY;wCAAmB;wCAAqB;wCAAsB;sCAC5EnK,QAAQ,CAACmK,KAAK1S,IAAI,GAChB;oCAEJ,uDAAuD;oCACjDgB,MAAM0R,KAAKxU,KAAK,CAACyQ,IAAI;oCAE3B,oBAAoB;oCAChB0H,eAAe7Z;oCACnB,IAAIwE,IAAIxB,UAAU,CAAC,QAAQwB,IAAIxB,UAAU,CAAC,MAAM6W,eAAe,AAACrV,IAAIxB,UAAU,CAAC,OAAQ7C,QAAQC;yCAC1F,IAAIoE,QAAQ,UAAUA,QAAQ,WAAWA,QAAQ,IAAIqV,eAAe3Z;yCACpE,IAAI,CAACgG,MAAMjG,OAAOuE,OAAOqV,eAAe5Z;oCAE7C,gBAAgB;oCAChBoD,OAAOgB,UAAU,CAAC6R,KAAK1S,IAAI,CAAC,GAAGqW;gCACnC;;gCAlBK;gCAAA;;;yCAAA,6BAAA;wCAAA;;;wCAAA;8CAAA;;;;4BAoBL,uBAAuB;4BACvB/X,sBAAsB8B,MAAM,CAACO,SAASoJ,KAAKlK;wBAC/C;wBAEA,0BAA0B;wBACpByW,cAAc9V,SAASyJ,aAAa,CAACtJ;wBAGtC,mCAAA,4BAAA;;4BADL,2CAA2C;4BAC3C,IAAK,aAAc,IAAI,CAACE,UAAU,uBAA7B,8BAAA,SAAA,0BAAA,kCAA+B;gCAAzB6R,QAAN;gCACD,IAAI;oCAAC;oCAAO;oCAAO;oCAAO;kCAAUnK,QAAQ,CAACmK,MAAK1S,IAAI,GAClD,UAAU,uCAAuC;gCACrDsW,YAAYzN,YAAY,CAAC6J,MAAK1S,IAAI,EAAE0S,MAAKxU,KAAK;4BAClD;;4BAJK;4BAAA;;;qCAAA,8BAAA;oCAAA;;;oCAAA;0CAAA;;;;wBAML,gDAAgD;wBAChD,MAAO,IAAI,CAACmS,UAAU,CAClBiG,YAAYlM,WAAW,CAAC,IAAI,CAACiG,UAAU;wBAE3C,kBAAkB;wBAClB,IAAI,CAACyC,WAAW,CAACwD;;;;;gBACrB;;;;WAxEEjW;qBAAgC4V;AA2EtC,6BAA6B;AAC7B,IAAA,AAAM1V,oCAAN;;cAAMA;aAAAA;gCAAAA;;gBAME,kBANFA;QAOE,MAAKqB,MAAM,GAAG,IAAIvF;;;kBAPpBkE;;YAUF6H,KAAAA;mBAAAA,SAAAA,yBAAyBpI,IAAI,EAAEqI,MAAM,EAAEC,MAAM;gBACzC,IAAItI,SAAS,QAAQsI,UAAUA,WAAWD,QACtC,IAAI,CAACqO,OAAO,CAACpO;YACrB;;;YAEAM,KAAAA;mBAAAA,SAAAA;gBACI,IAAI,CAACC,YAAY,CAAC,sBAAsB;gBACxC,IAAI,CAAC,IAAI,CAAC8N,iBAAiB,IAAI,IAAI,CAAC/V,YAAY,CAAC,OAC7C,IAAI,CAAC8V,OAAO,CAAC,IAAI,CAAC9V,YAAY,CAAC;YACvC;;;YAEAwI,KAAAA;mBAAAA,SAAAA;gBACI,+DAA+D;gBAC/D,IAAI,CAACxH,MAAM,CAACxD,OAAO,CAACqD,SAAAA;oBAChB,IAAIA,GAAG8F,KAAK,IAAIrI,OAAOmI,MAAM,EACzBnI,OAAOmI,MAAM,CAACuC,WAAW,CAACnI,GAAG8F,KAAK;gBAC1C;gBACA,IAAI,CAAC3F,MAAM,CAACgV,KAAK;YACrB;;;YAGMF,KAAAA;mBADN,AACA,0DAD0D;YAC1D,SAAMA,QAAQG,GAAG;;+BAKPC,WA6DIhY,SAQA2C;;;;;gCAzEV,IAAI,CAACoV,KACD;;;gCACJA,MAAMA,IAAIvZ,WAAW;gCAEfwZ,YAAY;oCACd,IAAMC,YAAY,MAAKvN,YAAY,CAAC,eAChC1K,UAAU,MAAK6X,iBAAiB;oCAEpC,sDAAsD;oCACtD,IAAI7X,WAAWiY,WAAW;wCACtB,wCAAwC;wCACxCjY,QAAQkY,YAAY,GAAGlY,QAAQmY,SAAS;wCAExC,gEAAgE;wCAChEnY,QAAQyK,YAAY,GAAG;wCACvB,MAAK3H,MAAM,CAACuB,GAAG,CAACrE,QAAQ6B,OAAO,CAACrD,WAAW,IAAIwB;wCAE/C,SAAS;wCACTA,QAAQuT,MAAM;wCAEd,4CAA4C;wCAC5CvT,QAAQyK,YAAY,GAAG;oCAC3B,OAAO;wCACH,qBAAqB;wCACrB,MAAK+C,eAAe;wCAEpB,kEAAkE;wCAClE,IAAIxN,WAAW,CAACiY,WACZ,MAAKnV,MAAM,CAACnC,MAAM,CAACX,QAAQ6B,OAAO,CAACrD,WAAW;oCACtD;oCAEA,kCAAkC;oCAClC,IAAImE;oCACJ,IAAIsV,aAAa,MAAKnV,MAAM,CAACsN,GAAG,CAAC2H,MAAM;wCACnCpV,KAAK,MAAKG,MAAM,CAACzB,GAAG,CAAC0W;wCAErB,0BAA0B;wCAC1B,IAAIpV,GAAGuV,YAAY,EACfvN,WAAW;mDAAMhI,GAAGwV,SAAS,GAAGxV,GAAGuV,YAAY;2CAAE;oCACzD,OAAO;wCACH,IAAI;4CACAvV,KAAKjB,SAASyJ,aAAa,CAAC4M;4CAC5B,sDAAsD;4CACtDla,MAAM2T,IAAI,CAAC,MAAKzP,UAAU,EAAEzC,OAAO,CAACsU,SAAAA;gDAChC,IAAI,CAAC;oDAAC;oDAAM;iDAAa,CAACnK,QAAQ,CAACmK,KAAK1S,IAAI,GACxCyB,GAAGoH,YAAY,CAAC6J,KAAK1S,IAAI,EAAE0S,KAAKxU,KAAK;4CAC7C;wCACJ,EAAE,OAAOgD,GAAG;4CACRvB,QAAQsN,KAAK,CAAC,AAAC,4BAA+B,OAAJ4J,KAAI,MAAI3V;wCACtD;oCACJ;oCAEA,aAAa;oCACb,IAAIO,IACA,MAAK2I,WAAW,CAAC3I;oCAErB,yBAAyB;oCACzB,OAAOA;gCACX;qCAGIjB,SAAS0W,mBAAmB,EAA5B1W;;;;gCACAA,SAAS0W,mBAAmB,CAAC;2CAAMJ;;;;;;;gCAEnC,iDAAiD;gCAC3ChY,UAAU,IAAI,CAAC6X,iBAAiB;qCAClC7X,SAAAA;;;;gCACAA,QAAQoL,KAAK,CAACiN,UAAU,GAAG;gCAC3BrY,QAAQoL,KAAK,CAACkN,OAAO,GAAG;gCACxB;;oCAAM,IAAIjY,QAAQkY,SAAAA;+CAAK5N,WAAW4N,GAAG;;;;gCAArC;;;gCAGJ,aAAa;gCACP5V,KAAKqV;gCACX,IAAIrV,IAAI;oCACJA,GAAGyI,KAAK,CAACkN,OAAO,GAAG;oCACnB3V,GAAGyI,KAAK,CAACiN,UAAU,GAAG;oCACtBG,sBAAsB;wCAClB7V,GAAGyI,KAAK,CAACkN,OAAO,GAAG;wCACnB3N,WAAW;4CACPhI,GAAGyI,KAAK,CAACiN,UAAU,GAAG;4CACtB1V,GAAGyI,KAAK,CAACkN,OAAO,GAAG;wCACvB,GAAG;oCACP;gCACJ;;;;;;;;gBAER;;;;;YArHWpB,KAAAA;iBAAX;gBACI,OAAO;oBAAC;iBAAK;YACjB;;;WAHEzV;qBAA4B0V;AAyHlC,8CAA8C;AAC9C,IAAI;IACA,IAAIzV,SAAS+W,UAAU,KAAK,WAAW;QACnCrY,OAAOsQ,gBAAgB,CAAC,oBAAoBlR,sBAAsBC,KAAK,EAAE;YAAEkR,MAAM;QAAK;IAC1F,OAAO;QACHnR,sBAAsBC,KAAK;IAC/B;AACJ,EAAE,OAAO2C,GAAG;IACRvB,QAAQC,IAAI,CAAC,wCAAwCsB;AACzD","file":"AlpineComponentLoader.js","sourcesContent":["/**\n * @license AlpineComponentLoader\n *\n * Copyright (c) LTDev LLC\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// Cache for constructible stylesheets (Internal styles only)\nconst styleSheetCache = new Map();\n\n// Cache for External Script loading states (Prevent duplicate execution)\nconst scriptLoadCache = new Map();\n\n// Type map for prop attribute definitions\nconst typeMap = {\n    'String': String,\n    'Number': Number,\n    'Boolean': Boolean,\n    'Array': Array,\n    'Object': Object\n};\n\n// Cache for xxternal data requests (Prevent duplicate API calls)\nconst dataFetchCache = new Map();\n\n// Helper to convert JS style objects to CSS strings\nconst toCssString = (styleObj) => {\n    return Object.entries(styleObj)\n        .map(([k, v]) => `${k.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`)}:${v}`)\n        .join(';');\n};\n\n// Helper to ensure values are string-safe for URLs (stringifies objects/arrays)\nconst toUrlValue = (v) => encodeURIComponent((typeof v === 'object' && v !== null) ? JSON.stringify(v) : v);\n\n// Helper to convert JS objects to URLSearchParams (supports nested objects and arrays)\nfunction toSearchParamsDeep(obj) {\n    const _params = new URLSearchParams(),\n        // Support nested objects and arrays in query parameters\n        add = (key, value) => {\n            if (value == null)\n                return;\n\n            // Support arrays\n            if (Array.isArray(value))\n                return value.forEach((v) => add(key, v));\n\n            // Support nested objects\n            if (typeof value === \"object\") {\n                for (const [k, v] of Object.entries(value))\n                    add(`${key}[${k}]`, v);\n                return;\n            }\n\n            // Add parameter\n            _params.append(key, toUrlValue(value));\n        };\n\n    // Add parameters\n    for (const [k, v] of Object.entries(obj ?? {}))\n        add(k, v);\n\n    return _params;\n}\n\nexport default class AlpineComponentLoader {\n    static _started = false;\n    static _registry = new Map();\n    static _debugger = false;\n\n    // Global default configuration\n    static globalConfig = {\n        debug: false,\n        basePath: '',\n        errorCss: {},\n        shadow: false,\n        useConstructibleStyles: true,\n        sharedStyleSheets: [],\n        executeScripts: true,\n        stripStyles: false,\n        forwardEvents: [],\n        externalCss: [],\n        externalScripts: [],\n        defaultComponentName: 'acl-component',\n        defaultDynamicName: 'acl-dynamic',\n\n        // Data fetching\n        dataFetchParams: null,\n        dataFetchKeys: null,\n        dataFetchPoll: null,\n        dataFetchTimeout: 30000,\n\n        // Template caching\n        cacheTemplates: true,\n        _templateCacheVersion: '0.0.1',\n        _templateCachePrefix: 'alpine-component-loader-',\n        _templateCacheKey: `alpine-component-loader-0.0.1`,\n        _templateCacheExpire: 15 * 60 * 1000,\n    };\n\n    // Start loading components + setup component proxy\n    static async start() {\n        if (AlpineComponentLoader._started)\n            return;\n        AlpineComponentLoader._started = true;\n\n        // Cleanup old caches\n        await AlpineComponentLoader.pruneCaches();\n\n        // Register default components\n        AlpineComponentLoader.registerComponent();\n        AlpineComponentLoader.registerDynamicLoader();\n        AlpineComponentLoader.registerTemplates();\n    }\n\n    // Clear caches from unmatched versions\n    static async pruneCaches(prefix = AlpineComponentLoader.globalConfig._templateCachePrefix, current = AlpineComponentLoader.globalConfig._templateCacheKey) {\n        if (!('caches' in window))\n            return;\n        return await Promise.all((await caches.keys())\n            .filter(key => key.startsWith(prefix))\n            .filter(key => key !== current)\n            .map(key => caches.delete(key)));\n    }\n\n    // Manually clear all template caches\n    static async clearCache(current = AlpineComponentLoader.globalConfig._templateCacheKey) {\n        if (!('caches' in window)) {\n            console.warn('[ACL] Cache API not supported.');\n            return;\n        }\n\n        // Clear all caches with the specified prefix\n        return await Promise.all((await caches.keys())\n            .filter(key => key.startsWith(current))\n            .map(key => caches.delete(key)));\n    }\n\n    // Update global configuration\n    static config(options) {\n        Object.assign(AlpineComponentLoader.globalConfig, options);\n    }\n\n    // Register default custom component\n    static registerComponent(name = AlpineComponentLoader.globalConfig.defaultComponentName) {\n        if (!customElements.get(name))\n            customElements.define(name, AlpineDeclarativeLoader);\n    }\n\n    // Register default dynamic loader\n    static registerDynamicLoader(name = AlpineComponentLoader.globalConfig.defaultDynamicName) {\n        if (!customElements.get(name))\n            customElements.define(name, AlpineDynamicLoader);\n    }\n\n    // Auto-discover <template acl-component=\"name\"> elements\n    static registerTemplates() {\n        document.querySelectorAll('template[acl-component]').forEach(tpl => {\n            const tagName = tpl.getAttribute('acl-component');\n            if (!tagName)\n                return;\n\n            // Parse acl-props attribute as JSON\n            let config;\n            try {\n                config = {\n                    attributes: Object.fromEntries(Object.entries(JSON.parse(tpl.getAttribute('acl-props') || '{}')).map(([key, val]) => [\n                        key,\n                        (typeof val === 'object' && val.type) ? {\n                            ...val,\n                            type: typeMap[val.type] || String\n                        } : (typeMap[val] || String)\n                    ]))\n                }\n            } catch (e) {\n                console.warn(`[ACL] Invalid JSON in acl-props for <${tagName}>`, e);\n            }\n\n            // Define the component\n            AlpineComponentLoader.define(tagName, tpl, config || {});\n        });\n    }\n\n    // Toggle the built-in debugger\n    static toggleDebug() {\n        console.warn('[ACL] Debugger not loaded. Import \\\"acl-debugger.js\\\" to enable.');\n    }\n\n    // Prefetch a component's template by tag name to warm the cache\n    static async prefetch(tagName) {\n        const config = AlpineComponentLoader._registry.get(tagName);\n        if (!config) {\n            console.warn(`[ACL] Cannot prefetch <${tagName}>: component not defined.`);\n            return;\n        }\n        return await AlpineComponentLoader.loadTemplate(config.source, config.settings);\n    }\n\n    // Centralized static template loader for components\n    static async loadTemplate(source, settings) {\n        // Handle HTMLTemplateElement or ID selector\n        if (source instanceof HTMLTemplateElement) {\n            return source.content;\n        } else if (typeof source === 'string' && source.startsWith('#')) {\n            const el = document.querySelector(source);\n            if (!el)\n                return Promise.reject(new Error(`Template ID \"${source}\" not found`));\n            if (!(el instanceof HTMLTemplateElement))\n                return Promise.reject(new Error(`ID \"${source}\" is not a <template>`));\n            return el.content;\n        }\n\n        // Check Cache API\n        const useCache = settings.cacheTemplates && 'caches' in window,\n            faH = 'acl__fetched-at__';\n\n        // Cache API\n        let _cache;\n        if (useCache) {\n            try {\n                // Open cache\n                _cache = await caches.open(settings._templateCacheKey);\n\n                // Read from cache + check expiration\n                const match = await _cache.match(source);\n                if (match?.ok) {\n                    const fetchedAt = Number(match.headers.get(faH));\n                    if (!Number.isNaN(fetchedAt) && (Date.now() - fetchedAt) < settings._templateCacheExpire)\n                        return match.text();\n                    await _cache.delete(settings._templateCacheKey);\n                }\n            } catch { /* Ignore cache read errors */ }\n        }\n\n        // Network fetch\n        const res = await fetch(source, { cache: 'no-store' });\n        if (!res.ok)\n            throw new Error(`HTTP ${res.status}`);\n\n        // Write to Cache API\n        if (useCache) {\n            try {\n                // Clone response + headers\n                const clone = res.clone(),\n                    headers = new Headers(clone.headers);\n\n                // Set cache expiration header\n                headers.set(faH, Date.now().toString());\n\n                // Write to cache\n                await _cache.put(\n                    source,\n                    new Response(clone.body, {\n                        status: clone.status,\n                        statusText: clone.statusText,\n                        headers\n                    })\n                );\n            } catch { /* Ignore cache write errors */ }\n\n            // If the browser supports ReadableStream and it's a large file, return the stream\n            if (res.body && typeof ReadableStream !== 'undefined')\n                return res.body.pipeThrough(new TextDecoderStream());\n        }\n\n        // Return HTML string\n        return res.text();\n    }\n\n    // Define a new component from a URL, ID, or Template element\n    static define(tagName, source, config = {}) {\n        // Merge defaults, global config, and instance config\n        const settings = {\n            attributes: {},\n            loading: 'eager',\n            hooks: {\n                beforeFetch: (opts) => opts,\n                afterFetch: (data) => data,\n            },\n            ...AlpineComponentLoader.globalConfig,\n            ...config,\n            externalCss: [\n                ...(AlpineComponentLoader.globalConfig.externalCss || []),\n                ...(config.externalCss || [])\n            ],\n            externalScripts: [\n                ...(AlpineComponentLoader.globalConfig.externalScripts || []),\n                ...(config.externalScripts || [])\n            ],\n            sharedStyleSheets: [\n                ...(AlpineComponentLoader.globalConfig.sharedStyleSheets || []),\n                ...(config.sharedStyleSheets || [])\n            ],\n            errorCss: {\n                ...{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    gap: '0.5rem',\n                    padding: '1rem',\n                    border: '1px solid #fca5a5',\n                    backgroundColor: '#fee2e2',\n                    color: '#991b1b',\n                    borderRadius: '6px',\n                    fontFamily: 'sans-serif',\n                    fontSize: '0.9rem'\n                },\n                ...(AlpineComponentLoader.globalConfig.errorCss || {}),\n                ...(config.errorCss || {})\n            },\n            forwardEvents: [\n                ...(AlpineComponentLoader.globalConfig.forwardEvents || []),\n                ...(config.forwardEvents || [])\n            ],\n            fallback: config.fallback || null,\n            persist: config.persist || false,\n            persistKey: config.persistKey || null,\n            persistDebounce: config.persistDebounce || 250,\n            bindStore: config.bindStore || null,\n            dataSrc: config.dataSrc || null,\n            dataFetchParams: config.dataFetchParams || AlpineComponentLoader.globalConfig.dataFetchParams || null,\n            dataFetchKeys: config.dataFetchKeys || AlpineComponentLoader.globalConfig.dataFetchKeys || null,\n            dataFetchPoll: config.dataFetchPoll || AlpineComponentLoader.globalConfig.dataFetchPoll || null,\n            dataFetchTimeout: config.dataFetchTimeout || AlpineComponentLoader.globalConfig.dataFetchTimeout || 30000,\n            dataFetchOptions: config.dataFetchOptions || {},\n        };\n\n        // Track observed attributes internally\n        const observedAttrs = [\n            ...new Set([\n                ...Object.keys(settings.attributes),\n                'bind-store',\n                'data-src',\n                'data-fetch-params',\n                'data-fetch-keys',\n                'data-fetch-poll',\n                'data-fetch-timeout',\n            ]),\n        ];\n\n        // Prepend base path if source is a URL string\n        let contentSource = source;\n        if (typeof source === 'string' && !source.startsWith('#') && settings.basePath)\n            contentSource = settings.basePath + source;\n\n        // Register in internal registry to enable prefetching\n        AlpineComponentLoader._registry.set(tagName, { source: contentSource, settings });\n\n        // Return helpers to be assigned to $el.$props\n        const helpers = (_this) => ({\n            $emit: (name, detail) => _this.dispatchEvent(new CustomEvent(name, {\n                bubbles: true,\n                composed: true,\n                detail\n            })),\n            $reload: () => _this.reload(),\n        });\n\n        // Create component class\n        class AlpineExternalComponent extends HTMLElement {\n            constructor() {\n                super();\n\n                // Initialize props\n                let _$props = {\n                    $data: null,\n                    $loading: false,\n                    $error: null,\n                    $lastUpdated: Date.now(),\n                    ...helpers(this),\n                    ...settings.attributes || {}\n                };\n\n                // Initialize state and attributes\n                this._initialized = false;\n                this._loading = false;\n                this._disconnectTimeout = null;\n                this._fetchAbortController = null;\n                this.$props = window.Alpine ? window.Alpine.reactive(_$props) : _$props;\n                this._root = settings.shadow ? this.attachShadow({ mode: 'open' }) : this;\n                this._observer = null;\n                this._scopeId = `scope-${Math.random().toString(36).slice(2, 9)}`;\n                this._slotObserver = null;\n                this._originalLightDom = document.createDocumentFragment();\n                this._pollTimer = null;\n            }\n\n            // Define observed attributes\n            static get observedAttributes() {\n                return observedAttrs;\n            }\n\n            // Reactively update props when attributes change\n            attributeChangedCallback(name, oldVal, newVal) {\n                if (oldVal === newVal)\n                    return;\n\n                // Watch data-src and renamed fetch attributes\n                if (['data-src', 'data-fetch-params', 'data-fetch-keys', 'data-fetch-timeout'].includes(name)) {\n                    if (this._initialized)\n                        this._fetchData(this.getAttribute('data-src') || settings.dataSrc);\n                } else if (name === 'data-poll')\n                    this._startPolling(); // Restart polling with new interval\n                else\n                    this._updateProp(name, newVal);\n\n                // Emit updated event\n                if (this._initialized) {\n                    this._triggerHook('updated', { name, oldVal, newVal });\n                }\n            }\n\n            // Initialize on insertion\n            connectedCallback() {\n                this.setAttribute('data-acl-component', this.tagName);\n\n                // If we are just moving nodes, the disconnect timer is still running\n                // We clear it so the component stays alive\n                if (this._disconnectTimeout) {\n                    clearTimeout(this._disconnectTimeout);\n                    this._disconnectTimeout = null;\n                    return; // It was just a move, do nothing.\n                }\n\n                // If kept-alive and already initialized, just reactivate\n                if (this._initialized) {\n                    this._triggerHook('activated');\n                    return;\n                }\n\n                // Guard against parallel loading or already initialized states\n                if (this._loading)\n                    return;\n\n                // Lock loading state\n                this._loading = true;\n\n                // Sync attributes immediately for eager loading\n                this._syncAllAttributes();\n\n                // Check loading mode and load\n                const loadMode = this.getAttribute('loading') || settings.loading;\n                if (loadMode === 'lazy')\n                    this._initLazyObserver();\n                else if (loadMode === 'idle')\n                    this._initIdleLoader();\n                else\n                    this._load();\n\n                // Initialize data polling if configured\n                this._startPolling();\n            }\n\n            // Cleanup memory on removal\n            disconnectedCallback() {\n                // Stop polling\n                this._stopPolling();\n\n                // Stop observing slots\n                if (this._slotObserver) {\n                    this._slotObserver.disconnect();\n                    this._slotObserver = null;\n                }\n\n                // If flagged with keep-alive, skip destruction\n                if (this._isKeptAlive || this.hasAttribute('keep-alive')) {\n                    this._triggerHook('deactivated');\n                    return;\n                }\n\n                // Don't destroy immediately; give moves/rewrites time to reattach\n                this._disconnectTimeout = setTimeout(() => {\n                    // If we got re-attached after a slower move, abort cleanup\n                    if (this.isConnected) {\n                        this._disconnectTimeout = null;\n                        return;\n                    }\n\n                    // Emit unmounted\n                    this._triggerHook('unmounted');\n\n                    // Cancel any pending fetches\n                    if (this._fetchAbortController)\n                        this._fetchAbortController.abort();\n                    if (this._observer)\n                        this._observer.disconnect();\n                    if (this._root && window.Alpine && this._initialized)\n                        window.Alpine.destroyTree(this._root);\n\n                    // Reset state so the component can revive if re-attached\n                    this._initialized = false;\n                    this._loading = false;\n                    this._disconnectTimeout = null;\n                }, 250);\n            }\n\n            // Initiate the recursive polling timeout\n            _startPolling() {\n                this._stopPolling();\n                const interval = parseInt(this.getAttribute('data-fetch-poll') || settings.dataFetchPoll);\n                if (isNaN(interval) || interval <= 0)\n                    return;\n\n                // Start the timer\n                this._pollTimer = setTimeout(async () => {\n                    if (!this.isConnected)\n                        return;\n\n                    // Fetch data again\n                    const src = this.getAttribute('data-src') || settings.dataSrc;\n                    if (src && this._initialized && !this.$props.$loading)\n                        await this._fetchData(src, true);\n\n                    // Schedule next tick\n                    this._startPolling();\n                }, interval);\n            }\n\n            // Clear the active polling timeout\n            _stopPolling() {\n                if (this._pollTimer) {\n                    clearTimeout(this._pollTimer);\n                    this._pollTimer = null;\n                }\n            }\n\n            // intersectionObserver for lazy loading\n            _initLazyObserver() {\n                const placeholder = document.createElement('div');\n                placeholder.style.minHeight = '1px';\n                this._root.appendChild(placeholder);\n                this._observer = new IntersectionObserver((entries) => {\n                    if (entries[0].isIntersecting) {\n                        this._load();\n                        this._observer.disconnect();\n                        this._observer = null; // Kill the observer reference\n                    }\n                }, { rootMargin: '100px' });\n                this._observer.observe(this);\n            }\n\n            // Idle loading strategy\n            _initIdleLoader() {\n                if ('requestIdleCallback' in window) {\n                    requestIdleCallback(() => this._load(), { timeout: 2000 });\n                } else {\n                    setTimeout(() => this._load(), 200);\n                }\n            }\n\n            // Initialize MutationObserver for dynamic Light DOM slots\n            _initSlotObserver() {\n                if (this._slotObserver)\n                    return;\n\n                this._slotObserver = new MutationObserver((mutations) => mutations.forEach(mutation => {\n                    mutation.addedNodes.forEach(node => {\n                        // Only handle Elements and Text nodes\n                        if (node.nodeType !== Node.ELEMENT_NODE && node.nodeType !== Node.TEXT_NODE)\n                            return;\n\n                        // Ignore the slot containers themselves if they trigger an add\n                        if (node.nodeType === Node.ELEMENT_NODE && node.hasAttribute('data-acl-slot'))\n                            return;\n\n                        // Determine target slot name + find the internal slot container\n                        const slotName = (node.nodeType === Node.ELEMENT_NODE ? node.getAttribute('slot') : null) || 'default',\n                            container = this._root.querySelector(`div[data-acl-slot=\"${slotName}\"]`);\n\n                        // Move the node into the container\n                        if (container)\n                            container.appendChild(node);\n                    });\n                }));\n\n                // Only observe direct children additions\n                this._slotObserver.observe(this, { childList: true });\n            }\n\n            // Allow the component to be reloaded\n            async reload() {\n                if (this._loading)\n                    return;\n                console.log(`[ACL] Reloading <${tagName}>...`);\n\n                // Clear data cache for this specific endpoint\n                const currentDataSrc = this.getAttribute('data-src') || settings.dataSrc;\n                if (currentDataSrc)\n                    dataFetchCache.delete(currentDataSrc);\n\n                // Clear caches specific to this component's source\n                if (settings.cacheTemplates) {\n                    const cache = await caches.open(settings._templateCacheKey);\n                    await cache.delete(contentSource);\n                }\n\n                // Reset state\n                this._initialized = false;\n                this.$props.$loading = true;\n                this.$props.$error = null;\n                this.$props.$data = null;\n\n                // Re-trigger load\n                await this._load();\n            }\n\n            // Main load sequence\n            async _load() {\n                const startMark = performance.now();\n                try {\n                    // Lock loading state\n                    if (this._initialized)\n                        return;\n\n                    // Emit beforeMount\n                    this._triggerHook('beforeMount');\n\n                    // Load external dependencies, get content, and data if needed\n                    const promises = [\n                        (settings.externalCss.length || settings.externalScripts.length) ? this._loadExternalDependencies() : Promise.resolve(),\n                        this._resolveContent(contentSource),\n                        (settings.dataSrc || this.getAttribute('data-src')) ? this._fetchData(this.getAttribute('data-src') || settings.dataSrc) : Promise.resolve(),\n                    ];\n\n                    // Get content from the resolved source\n                    const content = (await Promise.all(promises))[1];\n\n                    // Capture existing children for slotting if using Light DOM\n                    let lightSlots = null;\n                    if (!settings.shadow)\n                        lightSlots = this._captureLightSlots();\n\n                    // Strict clear of root element\n                    this._root.replaceChildren();\n\n                    // Inject CSS Links into Shadow (Apply Styles locally)\n                    if (settings.shadow && settings.externalCss.length) {\n                        settings.externalCss.forEach(url => {\n                            const link = document.createElement('link');\n                            link.rel = 'stylesheet';\n                            link.href = url;\n                            this._root.appendChild(link);\n                        });\n                    }\n\n                    // Render content safely\n                    await this._renderSafe(content, lightSlots);\n\n                    // Setup event bubbling for Shadow DOM\n                    if (settings.shadow && settings.forwardEvents.length > 0)\n                        this._setupEventForwarding();\n\n                    // Start observing Light DOM for dynamic updates\n                    if (!settings.shadow)\n                        this._initSlotObserver();\n\n                    // Initialize Alpine\n                    await this._initAlpine();\n\n                    // Stop timer and store metrics\n                    this._perf = { duration: performance.now() - startMark };\n\n                    // Mark success and unlock\n                    this._initialized = true;\n                    this._loading = false;\n\n                    // Dispatch 'mount' event\n                    this._dispatch('mount');\n                    this._triggerHook('mounted');\n\n                    //Dispatch 'loaded' event\n                    this._dispatch('loaded');\n                } catch (err) {\n                    console.error(`[ACL] <${tagName}>`, err);\n                    this._loading = false; // Unlock on error so we can retry\n                    const fallbackSource = this.getAttribute('fallback') || settings.fallback;\n                    if (fallbackSource) {\n                        try {\n                            // Clear failed state\n                            this._root.replaceChildren();\n\n                            // Render fallback; pass null for slots as fallback usually doesn't slot user content\n                            await this._renderSafe(await this._resolveContent(fallbackSource), null);\n\n                            // Init Alpine (so fallback can be interactive)\n                            await this._initAlpine();\n\n                            // Stop timer and store metrics\n                            this._perf = { duration: performance.now() - startMark };\n\n                            // Mark success and unlock\n                            this._initialized = true;\n\n                            // Dispatch 'loaded' event\n                            this._dispatch('loaded');\n\n                            // Stop here, do not render default error\n                            return;\n                        } catch (fallbackErr) {\n                            console.error(`[ACL] <${tagName}> Fallback Failed:`, fallbackErr);\n                            // If fallback fails, show original error (or combined)\n                            this._renderError(`Load Failed: ${err.message}. (Fallback also failed)`);\n                        }\n                    } else {\n                        // Standard Error Display\n                        this._renderError(err.message);\n                    }\n                }\n            }\n\n            // Handle data fetching for APIs with caching, placeholders, and parameters\n            async _fetchData(url, skipCache = false) {\n                if (!url)\n                    return;\n\n                // Abort any pending component request and init new controller\n                if (this._fetchAbortController)\n                    this._fetchAbortController.abort();\n                this._fetchAbortController = new AbortController();\n                const signal = this._fetchAbortController.signal;\n\n                // Initialize reactive states for loading and error resets\n                this.$props.$loading = true;\n                this.$props.$error = null;\n                this.$props.$data = null;\n\n                // Enforce request timeout via AbortController cancellation\n                const timeoutId = setTimeout(() => this._fetchAbortController.abort('Timeout'), settings.dataFetchTimeout);\n\n                try {\n                    // Helper to resolve attributes as JSON, Expressions, or Functions (Sync/Async)\n                    const resolveValue = async (attrName, configVal) => {\n                        let result = {};\n                        const attrVal = this.getAttribute(attrName),\n                            context = {\n                                el: this,\n                                $el: this,\n                                props: this.$props,\n                                $props: this.$props,\n                                root: this._root,\n                                $root: this._root,\n                            };\n                        if (attrVal) {\n                            const trimmed = attrVal.trim();\n                            try {\n                                // Attempt standard JSON parsing first\n                                if (trimmed.startsWith('{') || trimmed.startsWith('['))\n                                    result = JSON.parse(trimmed.replace(/'/g, '\"'));\n                                else throw new Error();\n                            } catch {\n                                try {\n                                    // Evaluate as JS: supports arrow functions and dynamic expressions\n                                    // We inject $props and $el into the function scope for convenience\n                                    const evaled = (new Function('$props', '$el', `return (${trimmed})`))(this.$props, this);\n                                    result = typeof evaled === 'function' ? await evaled.call(this, context) : evaled;\n                                } catch (e) {\n                                    console.warn(`[ACL] Invalid value in ${attrName} for <${tagName}>`, e);\n                                }\n                            }\n                        }\n\n                        // Merge with JS-based configuration (if provided)\n                        if (configVal) {\n                            result = {\n                                ...result,\n                                ...(\n                                    (\n                                        typeof configVal === 'function'\n                                            ? await configVal.call(this, context)\n                                            : configVal\n                                    ) || {})\n                            };\n                        }\n\n                        return result;\n                    };\n\n                    // Resolve placeholders and query parameters from both HTML and JS config\n                    const keys = await resolveValue('data-fetch-keys', settings.dataFetchKeys),\n                        params = await resolveValue('data-fetch-params', settings.dataFetchParams);\n\n                    // Perform URL placeholder replacement (e.g., :userId -> 123)\n                    let resolvedUrl = url;\n                    Object.entries(keys).forEach(([k, v]) => resolvedUrl = resolvedUrl.replace(`:${k}`, toUrlValue(v)));\n\n                    // Build final URL string with appended query parameters\n                    let finalUrl = new URL(resolvedUrl, window.location.origin);\n                    if (Object.keys(params).length > 0)\n                        finalUrl.search = toSearchParamsDeep(params).toString();\n\n                    // Convert to string for caching\n                    finalUrl = finalUrl.toString();\n\n                    // Bypass shared cache if requested\n                    if (skipCache)\n                        dataFetchCache.delete(finalUrl);\n\n                    // Shared cache management (Deduplicate identical requests)\n                    if (!dataFetchCache.has(finalUrl)) {\n                        const fetchTask = (async () => {\n                            let options = {\n                                method: 'GET',\n                                headers: { 'Accept': 'application/json' },\n                                ...AlpineComponentLoader.globalConfig?.dataFetchOptions || {},\n                                ...settings?.dataFetchOptions || {}\n                            };\n\n                            // Apply beforeFetch hook for global or local request customization\n                            if (typeof settings?.hooks?.beforeFetch === 'function') {\n                                try {\n                                    const modified = await settings.hooks.beforeFetch(options);\n                                    if (modified && typeof modified === 'object')\n                                        options = modified;\n                                } catch (e) {\n                                    console.warn(`[ACL] beforeFetch hook error for <${tagName}>`, e);\n                                }\n                            }\n\n                            // Fetch and validate response status and content type\n                            const res = await fetch(finalUrl, options);\n                            if (!res.ok)\n                                throw new Error(`API Error: ${res.status}`);\n\n                            // Validate content type header as JSON\n                            const contentType = res.headers.get(\"content-type\");\n                            if (!contentType?.includes(\"application/json\"))\n                                throw new Error(\"Invalid JSON response\");\n\n                            // Parse JSON response\n                            return await res.json();\n                        })();\n\n                        // Store pending promise in cache and prune on failure\n                        dataFetchCache.set(finalUrl, fetchTask);\n                        fetchTask.catch(() => dataFetchCache.delete(finalUrl));\n                    }\n\n                    // Race the shared network task against local abort/timeout logic\n                    const json = await Promise.race([\n                        dataFetchCache.get(finalUrl),\n                        new Promise((_, reject) => signal.addEventListener('abort', () => reject(new Error('Aborted')), { once: true }))\n                    ]);\n\n                    // Transform received data via afterFetch hook\n                    let processedData = json;\n                    if (typeof settings?.hooks?.afterFetch === 'function') {\n                        try {\n                            let modified = await settings.hooks.afterFetch(json);\n                            if (modified && typeof modified === 'object')\n                                processedData = modified;\n                        } catch (e) {\n                            console.warn(`[ACL] afterFetch hook error for <${tagName}>`, e);\n                        }\n                    }\n\n                    // Finalize component data update if not locally aborted\n                    if (!signal.aborted)\n                        this.$props.$data = processedData;\n\n                } catch (e) {\n                    // Handle errors or timeout cancellations for the specific instance\n                    if (signal.aborted) {\n                        if (signal.reason === 'Timeout') {\n                            this.$props.$error = `Request timed out after ${settings.fetchTimeout}ms`;\n                            this.$props.$data = null;\n                        }\n                        return;\n                    }\n                    console.error(`[ACL] Fetch failed for ${url}`, e);\n                    this.$props.$error = e.message;\n                    this.$props.$data = null;\n                } finally {\n                    // Cleanup timers and unlock component loading states\n                    clearTimeout(timeoutId);\n                    if (!signal.aborted || signal.reason === 'Timeout') {\n                        this.$props.$loading = false;\n                        if (this._fetchAbortController?.signal === signal)\n                            this._fetchAbortController = null;\n                    }\n                }\n            }\n\n            // Helper to execute hooks\n            _triggerHook(hookName, detail = {}) {\n                if (settings.hooks && typeof settings.hooks[hookName] === 'function') {\n                    settings.hooks[hookName].call(this, {\n                        el: this,\n                        root: this._root,\n                        props: this.$props,\n                        ...detail\n                    });\n                }\n            }\n\n            // Load external CSS/JS dependencies\n            async _loadExternalDependencies() {\n                const promises = [];\n\n                // CSS: Always inject into global head\n                // This ensures @font-face and @keyframes are registered globally\n                settings.externalCss.forEach(url => {\n                    // Check if link exists in head\n                    if (!document.querySelector(`link[href=\"${url}\"]`)) {\n                        const link = document.createElement('link');\n                        link.rel = 'stylesheet';\n                        link.href = url;\n                        document.head.appendChild(link);\n                    }\n                });\n\n                // Scripts: Only inject if not already loaded\n                // This ensures scripts are loaded in the correct order\n                settings.externalScripts.forEach(url => {\n                    if (!scriptLoadCache.has(url)) {\n                        const p = new Promise((resolve, reject) => {\n                            if (document.querySelector(`script[src=\"${url}\"]`)) {\n                                resolve();\n                                return;\n                            }\n                            const script = document.createElement('script');\n                            script.src = url;\n                            script.async = true;\n                            script.onload = () => resolve();\n                            script.onerror = () => reject(new Error(`Failed to load script: ${url}`));\n                            document.head.appendChild(script);\n                        });\n                        scriptLoadCache.set(url, p);\n                    }\n                    promises.push(scriptLoadCache.get(url));\n                });\n\n                // Wait for all promises\n                await Promise.all(promises);\n            }\n\n            // Manual slot polyfill for Light DOM\n            _captureLightSlots() {\n                // Recover slotted nodes if re-rendering (prevent loss)\n                if (this._initialized)\n                    this._root.querySelectorAll('[data-acl-slot]').forEach(container => {\n                        while (container.firstChild)\n                            this._originalLightDom.appendChild(container.firstChild);\n                    });\n\n                // Capture any new direct children (First load or dynamic additions)\n                while (this.firstChild)\n                    this._originalLightDom.appendChild(this.firstChild);\n\n                // We iterate the storage fragment to sort nodes into the slots map\n                // Note: The nodes physically exist in the fragment until moved by _renderSafe\n                return Array.from(this._originalLightDom.childNodes).reduce((slots, node) => {\n                    // Determine slot name\n                    const name = (\n                        node.nodeType === Node.ELEMENT_NODE && node.hasAttribute('slot')\n                    ) ? node.getAttribute('slot') : 'default';\n\n                    // Add node to slot\n                    return {\n                        ...slots,\n                        [name]: (slots[name] || []).concat(node)\n                    };\n                }, { default: [] });\n            }\n\n            // Render logic using DOM manipulation\n            async _renderSafe(content, lightSlots) {\n                let rootNode;\n\n                // Convert stream to string if needed\n                if (content instanceof ReadableStream) {\n                    const reader = content.getReader(),\n                        decoder = new TextDecoder(),\n                        accumulator = [];\n                    while (true) {\n                        const { done, value } = await reader.read();\n                        if (done)\n                            break;\n                        accumulator.push(typeof value === 'string' ? value : decoder.decode(value, { stream: true }));\n                    }\n                    content = accumulator.join('') + decoder.decode();\n\n                    console.log('[ACL] Stream content loaded as string.');\n                }\n\n                // Parse string to DOM if needed, otherwise clone fragment\n                if (typeof content === 'string') {\n                    // Parse HTML to DOM\n                    const doc = (new DOMParser()).parseFromString(content, 'text/html');\n\n                    // Create document fragment to hold elements\n                    rootNode = document.createDocumentFragment();\n\n                    // Move elements from head/body (styles, title, meta and actual markup)\n                    [\n                        ...Array.from(doc.head.childNodes),\n                        ...Array.from(doc.body.childNodes),\n                    ].forEach(node => rootNode.appendChild(node));\n                } else\n                    rootNode = content.cloneNode(true);\n\n                // Process styles (constructible, scoping, or stripping)\n                if (!settings.stripStyles) {\n                    const styles = Array.from(rootNode.querySelectorAll('style'));\n\n                    // Constructible stylesheets (Shadow DOM only)\n                    if (settings.shadow && settings.useConstructibleStyles && document.adoptedStyleSheets) {\n                        const combinedCss = styles.map(s => s.textContent).join('\\n');\n                        let sheet = null;\n\n                        if (combinedCss.trim().length > 0) {\n                            if (styleSheetCache.has(combinedCss))\n                                sheet = styleSheetCache.get(combinedCss);\n                            else {\n                                sheet = new CSSStyleSheet();\n                                sheet.replaceSync(combinedCss);\n                                styleSheetCache.set(combinedCss, sheet);\n                            }\n                        }\n\n                        // Apply shared + internal styles\n                        this._root.adoptedStyleSheets = [\n                            ...(settings.sharedStyleSheets || []),\n                            ...(sheet ? [sheet] : [])\n                        ];\n\n                        // Remove style tags since we moved them to adoptedStyleSheets\n                        styles.forEach(el => el.remove());\n                    } else {\n                        // Fallback: Standard tag injection + scoping\n                        styles.forEach(style => {\n                            if (!settings.shadow) {\n                                // Native @scope support\n                                if ('CSSScopeRule' in window) {\n                                    style.textContent = `@scope { ${style.textContent.replace(/:host/g, ':scope')} }`;\n                                } else {\n                                    this.setAttribute('data-scope', this._scopeId);\n\n                                    // Handles :host(.active) -> tagName[data-scope].active\n                                    // Handles :host -> tagName[data-scope]\n                                    const scopeSelector = `${tagName}[data-scope=\"${this._scopeId}\"]`;\n                                    if (style.textContent.includes(':host')) {\n                                        style.textContent = style.textContent\n                                            .replace(/:host\\s*\\(([^)]+)\\)/g, `${scopeSelector}$1`) // Handle :host(...)\n                                            .replace(/:host/g, scopeSelector);                     // Handle :host\n                                    }\n                                }\n                            }\n                        });\n                    }\n                } else {\n                    rootNode.querySelectorAll('style').forEach(el => el.remove());\n                }\n\n                // Process scripts (security check and re-creation)\n                const scripts = [];\n                if (settings.executeScripts) {\n                    rootNode.querySelectorAll('script').forEach(oldScript => {\n                        const newScript = document.createElement('script');\n                        Array.from(oldScript.attributes).forEach(attr =>\n                            newScript.setAttribute(attr.name, attr.value)\n                        );\n                        newScript.textContent = oldScript.textContent;\n                        scripts.push(newScript);\n                        oldScript.remove();\n                    });\n                } else {\n                    rootNode.querySelectorAll('script').forEach(el => el.remove());\n                }\n\n                // Inject Light DOM slots if needed\n                if (!settings.shadow) {\n                    // Instead of replacing the slot entirely, we replace it with a persistent container\n                    // This allows us to append new nodes to it later via the MutationObserver\n                    rootNode.querySelectorAll('slot').forEach(slotEl => {\n                        const name = slotEl.getAttribute('name') || 'default';\n\n                        // Create a transparent wrapper acting as the slot\n                        const anchor = document.createElement('div');\n                        anchor.style.display = 'contents';\n                        anchor.setAttribute('data-acl-slot', name);\n\n                        // Insert pre-captured nodes (initial render)\n                        const nodesToInsert = lightSlots ? lightSlots[name] : null;\n                        if (nodesToInsert && nodesToInsert.length > 0) {\n                            nodesToInsert.forEach(node => anchor.appendChild(node));\n                        }\n                        // Fallback content (if no nodes provided)\n                        else if (slotEl.childNodes.length > 0) {\n                            while (slotEl.firstChild)\n                                anchor.appendChild(slotEl.firstChild);\n                        }\n\n                        // Replace the <slot> tag with our anchor\n                        slotEl.replaceWith(anchor);\n                    });\n                }\n\n                // Move nodes to component root\n                while (rootNode.firstChild) {\n                    const node = rootNode.firstChild;\n\n                    // Attach props directly to element\n                    if (node.nodeType === 1)\n                        node.$props = this.$props;\n\n                    // Append to root\n                    this._root.appendChild(node);\n                }\n\n                // Append scripts to trigger execution\n                scripts.forEach(s => this._root.appendChild(s));\n            }\n\n            // Forward specific events out of Shadow DOM\n            _setupEventForwarding() {\n                settings.forwardEvents.forEach(eventName => {\n                    this._root.addEventListener(eventName, (e) => {\n                        this.dispatchEvent(new CustomEvent(eventName, {\n                            bubbles: true,\n                            composed: true,\n                            detail: e.detail\n                        }));\n                    });\n                });\n            }\n\n            // Advanced prop validation and type casting\n            _updateProp(name, value) {\n                // Skip data-src, it's handled separately\n                if (name === 'data-src')\n                    return;\n\n                // Get config\n                const configDef = settings.attributes[name];\n\n                // Normalization: handle { type: String } vs just String\n                const type = (configDef && configDef.type) ? configDef.type : configDef,\n                    required = (configDef && configDef.required) === true,\n                    validator = (configDef && configDef.validator) ? configDef.validator : null,\n                    defaultValue = (configDef && configDef.hasOwnProperty('default')) ? configDef.default : undefined,\n                    options = (configDef && configDef.options) ? configDef.options : null,\n                    schema = (configDef && configDef.schema) ? configDef.schema : null;\n\n                // Handle null/undefined values\n                if (value === null || value === undefined) {\n                    if (defaultValue !== undefined) {\n                        this.$props[name] = defaultValue;\n                        return;\n                    }\n                    if (required)\n                        console.warn(`[ACL] Missing required prop \"${name}\" on <${tagName}>`);\n\n                    this._applyTypeDefault(name, type);\n                    return;\n                }\n\n                // Type Casting\n                let parsedValue;\n                if (type === Boolean) {\n                    parsedValue = (value !== null && value !== 'false');\n                } else if (type === Number) {\n                    const num = Number(value);\n                    parsedValue = isNaN(num) ? 0 : num;\n                } else if (type === Object || type === Array) {\n                    try {\n                        if (!value) parsedValue = (type === Array) ? [] : {};\n                        else parsedValue = JSON.parse(value.replace(/'/g, '\"'));\n                    } catch (e) {\n                        console.warn(`[ACL] Attribute \"${name}\" is invalid JSON:`, value);\n                        parsedValue = (type === Array) ? [] : {};\n                    }\n                } else {\n                    parsedValue = value;\n                }\n\n                // Validate against 'enums' (allowed values)\n                if (options && Array.isArray(options) && !options.includes(parsedValue)) {\n                    console.warn(`[ACL] Value \"${parsedValue}\" is not a valid option for prop \"${name}\" on <${tagName}>. Allowed:`, options);\n                    if (defaultValue !== undefined)\n                        this.$props[name] = defaultValue;\n                    else if (this.$props[name] === undefined)\n                        this._applyTypeDefault(name, type);\n                    return;\n                }\n\n                // Validate with a JSON Schema\n                if (schema && type === Object && typeof parsedValue === 'object' && parsedValue !== null) {\n                    if (Object.entries(schema).some(([k, t]) => {\n                        const val = parsedValue[k];\n                        if (val === undefined)\n                            return true;\n                        if (t === String)\n                            return typeof val !== 'string';\n                        if (t === Number)\n                            return typeof val !== 'number';\n                        if (t === Boolean)\n                            return typeof val !== 'boolean';\n                        if (t === Array)\n                            return !Array.isArray(val);\n                        if (t === Object)\n                            return typeof val !== 'object' || Array.isArray(val) || val === null;\n                        return false;\n                    })) {\n                        console.warn(`[ACL] Schema validation failed for prop \"${name}\" on <${tagName}>.`);\n                        if (defaultValue !== undefined)\n                            this.$props[name] = defaultValue;\n                        else if (this.$props[name] === undefined)\n                            this._applyTypeDefault(name, type);\n                        return;\n                    }\n                }\n\n                // Validation: Custom Validator\n                if (validator && typeof validator === 'function') {\n                    if (!validator(parsedValue)) {\n                        console.warn(`[ACL] Validation failed for prop \"${name}\" on <${tagName}>. Value:`, parsedValue);\n                        // If we have a default, use it\n                        if (defaultValue !== undefined)\n                            this.$props[name] = defaultValue;\n                        // If prop is currently undefined (initial load), set a safe type default\n                        else if (this.$props[name] === undefined)\n                            this._applyTypeDefault(name, type);\n                        // If prop already had a value (update), do nothing (keep old valid value)\n                        return;\n                    }\n                }\n\n                this.$props[name] = parsedValue;\n            }\n\n            // Helper for type safety\n            _applyTypeDefault(name, type) {\n                if (type === Number)\n                    this.$props[name] = 0;\n                else if (type === Boolean)\n                    this.$props[name] = false;\n                else if (type === Array)\n                    this.$props[name] = [];\n                else if (type === Object)\n                    this.$props[name] = {};\n                else this.$props[name] = '';\n            }\n\n            // Reactively update props when attributes change\n            _syncAllAttributes() {\n                observedAttrs.forEach(name => this._updateProp(name, this.getAttribute(name)));\n            }\n\n            // Initialize persistence strategy with helpers\n            _initPersistence() {\n                const mode = this.getAttribute('persist') || settings.persist;\n                if (!mode)\n                    return;\n\n                // Choose storage (default to sessionStorage if not specified), generate key, and debounce config\n                const storage = (mode === 'local') ? localStorage : sessionStorage,\n                    key = this.getAttribute('persist-key') || settings.persistKey ||\n                        `acl:${this.localName}:${this.id ? ':' + this.id : 'no-id'}`,\n                    debounceMs = parseInt(this.getAttribute('persist-debounce') || settings.persistDebounce || '250', 10);\n\n                // Debounce timer for persistence\n                let _timer = null;\n\n                // Create a clean snapshot\n                const getSnapshot = () => Object.fromEntries(\n                    Object.entries(this.$props)\n                        .filter(([k, v]) => !k.startsWith('$') && typeof v !== 'function')\n                );\n\n                // Perform immediate save\n                const saveNow = (value) => {\n                    if (_timer)\n                        clearTimeout(_timer);\n                    _timer = null;\n                    storage.setItem(key, JSON.stringify(value || getSnapshot()));\n                };\n\n                // Attach persistence helpers\n                this.$props.$persistence = {\n                    $key: key,\n                    $save: (value) => {\n                        if (debounceMs > 0) {\n                            if (_timer)\n                                clearTimeout(_timer);\n                            _timer = setTimeout(() => saveNow(value), debounceMs);\n                        } else {\n                            saveNow(value);\n                        }\n                    },\n                    $clear: () => {\n                        if (_timer)\n                            clearTimeout(_timer);\n                        _timer = null;\n                        storage.removeItem(key);\n                    },\n                    $get: (k = null, fallback = null) => {\n                        try {\n                            let stored = JSON.parse(storage.getItem(key));\n                            return (k ? stored[k] : stored) || fallback;\n                        } catch (e) {\n                            return fallback;\n                        }\n                    },\n                    $flush: () => {\n                        if (_timer)\n                            saveNow();\n                    }\n                };\n\n                // Restore state on load\n                try {\n                    const stored = this.$props.$persistence.$get();\n                    if (stored && typeof stored === 'object')\n                        for (const k in this.$props)\n                            if (Object.prototype.hasOwnProperty.call(stored, k))\n                                this.$props[k] = stored[k];\n                } catch (e) {\n                    console.warn(`[ACL] Restore failed for ${key}`, e);\n                }\n\n                // Start saving on Alpine updates\n                Alpine.effect(() => this.$props.$persistence.$save(getSnapshot()));\n\n                // Flush on page unload to prevent data loss\n                if (debounceMs > 0)\n                    window.addEventListener('beforeunload', () => this.$props.$persistence.$flush());\n            }\n\n            // Wait for Alpine.js to load\n            async _initAlpine() {\n                if (window.Alpine)\n                    return this._finishAlpineInit();\n\n                // Bind to alpine:init event + timeout if it is not fired\n                return new Promise((resolve, reject) => {\n                    document.addEventListener('alpine:init', () => {\n                        this._finishAlpineInit();\n                        resolve();\n                    }, { once: true });\n\n                    // Timeout\n                    setTimeout(() => {\n                        if (window.Alpine) {\n                            this._finishAlpineInit();\n                            resolve();\n                        }\n                        else\n                            reject(new Error(\"Alpine.js not found (Timeout)\"));\n                    }, 5000);\n                });\n            }\n\n            // Bridge props to Alpine store and init tree once Alpine is ready\n            _finishAlpineInit() {\n                // Bind Alpine store if provided\n                const storeName = this.getAttribute('bind-store') || settings.bindStore;\n                if (storeName) {\n                    let store = Alpine.store(storeName);\n                    if (store) {\n                        // Merge Alpine store with provided $props\n                        if (this.$props && typeof this.$props === 'object')\n                            Object.keys(this.$props)\n                                .filter(key => store[key] === undefined)\n                                .forEach(key => store[key] = this.$props[key]);\n\n                        // Set $props to Alpine store\n                        this.$props = store;\n                    } else {\n                        console.error(`[ACL] Store \"${storeName}\" not found. Falling back to local state.`);\n                        this.$props = window.Alpine.reactive(this.$props || {});\n                    }\n                } else {\n                    // Initialize Alpine Store\n                    this.$props = window.Alpine.reactive(this.$props || {});\n                }\n\n                // Initialize persistence\n                this._initPersistence();\n\n                // Track reactive updates for the debugger\n                // We manually touch all props *except* $lastUpdated to avoid an infinite loop\n                Alpine.effect(() => {\n                    if (this.$props) {\n                        Object.keys(this.$props).forEach(k => {\n                            if (k !== '$lastUpdated')\n                                void this.$props[k];\n                        });\n                        this.$props.$lastUpdated = Date.now();\n                    }\n                });\n\n                // Set an anonymous Alpine store for debugging\n                Alpine.store(`props_${tagName}_${Math.random().toString(36).slice(2)}`, this.$props);\n\n                // Pass the reactive reference to all children\n                // Any change to this.$props by children will now update the Store directly (and vice versa)\n                if (this._root && this._root.children)\n                    Array.from(this._root.children).forEach(node => {\n                        if (node.nodeType === 1)\n                            node.$props = this.$props;\n                    });\n\n                // We wrap in nextTick to ensure the DOM is settled before Alpine scans it\n                window.Alpine.nextTick(() => {\n                    if (this._root)\n                        window.Alpine.initTree(this._root);\n                });\n            }\n\n            // Render error message safely\n            _renderError(msg) {\n                const container = document.createElement('div');\n                container.style.cssText = toCssString(settings.errorCss);\n\n                const header = document.createElement('strong');\n                header.textContent = `Load Failed: <${tagName}>`;\n\n                const code = document.createElement('code');\n                code.textContent = msg;\n                code.style.display = 'block';\n                code.style.marginTop = '4px';\n                container.appendChild(header);\n                container.appendChild(code);\n\n                if (settings.shadow)\n                    this._root.replaceChildren(container);\n                else\n                    this._root.appendChild(container);\n            }\n\n            // Dispatch custom event\n            _dispatch(eventName) {\n                this.dispatchEvent(new CustomEvent(eventName, {\n                    bubbles: true,\n                    composed: true,\n                    detail: { props: this.$props }\n                }));\n            }\n\n            // Resolve URL string, ID selector, or Template object\n            async _resolveContent(source) {\n                return await AlpineComponentLoader.loadTemplate(source, settings);\n            }\n\n            // Helpers to deal with template caches within the component\n            // TODO: Implement as a an available Alpine directive/$props function\n            async _pruneCache() { return await AlpineComponentLoader.pruneCache(settings._templateCachePrefix, settings._templateCacheKey); }\n            async _clearCache() { return await AlpineComponentLoader.clearCache(settings._templateCacheKey); }\n        }\n\n        // Register custom element\n        customElements.define(tagName, AlpineExternalComponent);\n    }\n}\n\n// Declarative component proxy, replaces itself with the loaded component\nclass AlpineDeclarativeLoader extends HTMLElement {\n    async connectedCallback() {\n        const src = this.getAttribute('src') || this.getAttribute('url');\n        if (!src) {\n            console.error(`<${this.localName}>: missing \"src\" attribute`);\n            return;\n        }\n\n        // Determine Tag Name (Attribute > Filename)\n        let tagName = this.getAttribute('tag');\n        if (!tagName)\n            tagName = (src.split('/').pop()).split('.').shift(); // Strip extension\n\n        // Validate tag name; ensure it contains a hyphen\n        if (!tagName.includes('-')) {\n            console.error(`<${this.localName}>: Tag name \"${tagName}\" must contain a hyphen.`);\n            return;\n        }\n\n        // Parse Config from Attributes\n        const config = {\n            shadow: this.hasAttribute('shadow') ? (this.getAttribute('shadow') !== 'false') : AlpineComponentLoader.globalConfig.shadow,\n            loading: this.getAttribute('loading') || 'eager',\n            dataSrc: this.getAttribute('data-src') || null,\n            bindStore: this.getAttribute('bind-store') || null,\n            fallback: this.getAttribute('fallback') || null,\n            attributes: {} // Auto-inference of props\n        };\n\n        // Define the component (if not already defined)\n        if (!customElements.get(tagName)) {\n            // Heuristic: Check other attributes to guess Prop Types\n            for (const attr of this.attributes) {\n                if ([\n                    'src', 'url', 'tag', 'shadow', 'loading', 'class', 'style', 'id', 'bind-store', 'fallback',\n                    'data-src', 'data-fetch-keys', 'data-fetch-params', 'data-fetch-timeout', 'data-fetch-poll'\n                ].includes(attr.name))\n                    continue;\n\n                // If value looks like JSON Array/Object, treat as such\n                const val = attr.value.trim();\n\n                // Try to infer type\n                let inferredType = String;\n                if (val.startsWith('[') || val.startsWith('{')) inferredType = (val.startsWith('[')) ? Array : Object;\n                else if (val === 'true' || val === 'false' || val === '') inferredType = Boolean;\n                else if (!isNaN(Number(val))) inferredType = Number;\n\n                // Add to config\n                config.attributes[attr.name] = inferredType;\n            }\n\n            // Define the component\n            AlpineComponentLoader.define(tagName, src, config);\n        }\n\n        // Create the REAL element\n        const realElement = document.createElement(tagName);\n\n        // Forward Attributes (Props, Classes, IDs)\n        for (const attr of this.attributes) {\n            if (['src', 'url', 'tag', 'shadow'].includes(attr.name))\n                continue; // Don't forward loader-specific config\n            realElement.setAttribute(attr.name, attr.value);\n        }\n\n        // Move any children (slots) to the REAL element\n        while (this.firstChild)\n            realElement.appendChild(this.firstChild);\n\n        // Swap in the DOM\n        this.replaceWith(realElement);\n    }\n}\n\n// Dynamic component switcher\nclass AlpineDynamicLoader extends HTMLElement {\n    static get observedAttributes() {\n        return ['is'];\n    }\n\n    constructor() {\n        super();\n        this._cache = new Map();\n    }\n\n    attributeChangedCallback(name, oldVal, newVal) {\n        if (name === 'is' && newVal && newVal !== oldVal)\n            this._switch(newVal);\n    }\n\n    connectedCallback() {\n        this.setAttribute('data-acl-component', 'acl-dynamic');\n        if (!this.firstElementChild && this.getAttribute('is'))\n            this._switch(this.getAttribute('is'));\n    }\n\n    disconnectedCallback() {\n        // Cleanup cache to prevent memory leaks when loader is removed\n        this._cache.forEach(el => {\n            if (el._root && window.Alpine)\n                window.Alpine.destroyTree(el._root);\n        });\n        this._cache.clear();\n    }\n\n    // Switch to a new component with View Transitions support\n    async _switch(tag) {\n        if (!tag)\n            return;\n        tag = tag.toLowerCase();\n\n        const updateDOM = () => {\n            const keepAlive = this.hasAttribute('keep-alive'),\n                current = this.firstElementChild;\n\n            // Cache the current component if keep-alive is active\n            if (current && keepAlive) {\n                // Save scroll position before detaching\n                current._savedScroll = current.scrollTop;\n\n                // Mark as kept alive so disconnectedCallback doesn't destroy it\n                current._isKeptAlive = true;\n                this._cache.set(current.tagName.toLowerCase(), current);\n\n                // Detach\n                current.remove();\n\n                // Reset flag for future legitimate removals\n                current._isKeptAlive = false;\n            } else {\n                // Standard tear down\n                this.replaceChildren();\n\n                // If we turned off keep-alive, ensure we don't hold onto old refs\n                if (current && !keepAlive)\n                    this._cache.delete(current.tagName.toLowerCase());\n            }\n\n            // Restore or Create new component\n            let el;\n            if (keepAlive && this._cache.has(tag)) {\n                el = this._cache.get(tag);\n\n                // Restore scroll position\n                if (el._savedScroll)\n                    setTimeout(() => el.scrollTop = el._savedScroll, 0);\n            } else {\n                try {\n                    el = document.createElement(tag);\n                    // Forward attributes (excluding loader-specific ones)\n                    Array.from(this.attributes).forEach(attr => {\n                        if (!['is', 'keep-alive'].includes(attr.name))\n                            el.setAttribute(attr.name, attr.value);\n                    });\n                } catch (e) {\n                    console.error(`[ACL] Failed to create: <${tag}>`, e);\n                }\n            }\n\n            // Add to DOM\n            if (el)\n                this.appendChild(el);\n\n            // Return the new element\n            return el;\n        };\n\n        // Use native View Transitions if available for animated switching\n        if (document.startViewTransition) {\n            document.startViewTransition(() => updateDOM());\n        } else {\n            // Manual fallback transition logic (Fade out/in)\n            const current = this.firstElementChild;\n            if (current) {\n                current.style.transition = 'opacity 0.1s ease-out';\n                current.style.opacity = '0';\n                await new Promise(r => setTimeout(r, 100));\n            }\n\n            // Update DOM\n            const el = updateDOM();\n            if (el) {\n                el.style.opacity = '0';\n                el.style.transition = 'opacity 0.1s ease-in';\n                requestAnimationFrame(() => {\n                    el.style.opacity = '1';\n                    setTimeout(() => {\n                        el.style.transition = '';\n                        el.style.opacity = '';\n                    }, 100);\n                });\n            }\n        }\n    }\n}\n\n// Once DOM is ready, start loading components\ntry {\n    if (document.readyState === 'loading') {\n        window.addEventListener('DOMContentLoaded', AlpineComponentLoader.start, { once: true });\n    } else {\n        AlpineComponentLoader.start();\n    }\n} catch (e) {\n    console.warn(`[ACL] Failed to register components:`, e);\n}"]}
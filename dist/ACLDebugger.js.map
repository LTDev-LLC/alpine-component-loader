{"version":3,"sources":["../src/debugger.js"],"names":["debuggerCss","tooltip","position","zIndex","background","color","padding","borderRadius","fontSize","fontFamily","pointerEvents","border","boxShadow","maxWidth","whiteSpace","display","overlay","top","left","width","height","overflow","overlayBoxes","boxSizing","toCssString","styleObj","Object","entries","map","k","v","replace","m","toLowerCase","join","ACLDebugger","inject","loaderClass","console","error","toggleDebug","active","globalConfig","debug","document","body","classList","toggle","getElementById","createElement","id","style","cssText","titleNode","hr","margin","borderBottom","statusNode","propsNode","append","_nodes","title","status","props","appendChild","overlayContainer","mouseX","mouseY","hoveredElement","onMouseMove","e","clientX","clientY","composedPath","find","node","nodeType","hasAttribute","addEventListener","passive","renderLoop","AlpineComponentLoader","replaceChildren","removeEventListener","components","querySelectorAll","children","usedBoxCount","forEach","el","rect","getBoundingClientRect","nodes","shadowRoot","length","minX","Infinity","minY","maxX","maxY","found","child","cRect","Math","min","max","right","bottom","window","innerHeight","innerWidth","box","transform","i","textContent","getAttribute","_loading","JSON","stringify","$props","offset","tRect","winW","winH","requestAnimationFrame"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;CAOC,GAED,mBAAmB;AACnB,IAAMA,cAAc;IAChBC,SAAS;QACLC,UAAU;QACVC,QAAQ;QACRC,YAAY;QACZC,OAAO;QACPC,SAAS;QACTC,cAAc;QACdC,UAAU;QACVC,YAAY;QACZC,eAAe;QACfC,QAAQ;QACRC,WAAW;QACXC,UAAU;QACVC,YAAY;QACZC,SAAS;IACb;IACAC,SAAS;QACLd,UAAU;QACVe,KAAK;QACLC,MAAM;QACNC,OAAO;QACPC,QAAQ;QACRV,eAAe;QACfP,QAAQ;QACRkB,UAAU;IACd;IACAC,cAAc;QACVpB,UAAU;QACVS,QAAQ;QACRY,WAAW;IACf;AACJ;AAEA,oDAAoD;AACpD,IAAMC,cAAc,SAACC;IACjB,OAAOC,OAAOC,OAAO,CAACF,UACjBG,GAAG,CAAC;iDAAEC,eAAGC;eAAO,AAAC,GAAqDA,OAAnDD,EAAEE,OAAO,CAAC,UAAUC,SAAAA;mBAAK,AAAC,IAAmB,OAAhBA,EAAEC,WAAW;YAAM,KAAK,OAAFH;OACtEI,IAAI,CAAC;AACd;AAGe,IAAA,AAAMC,4BAAN;;aAAMA;gCAAAA;;kBAAAA;;YACVC,KAAAA;mBAAP,SAAOA,OAAOC,WAAW;gBACrB,IAAI,CAACA,aAAa;oBACdC,QAAQC,KAAK,CAAC;oBACd;gBACJ;gBAEA,yDAAyD;gBACzDF,YAAYG,WAAW,GAAG;oBACtB,IAAMC,SAAU,IAAI,CAACC,YAAY,CAACC,KAAK,GAAG,CAAC,IAAI,CAACD,YAAY,CAACC,KAAK;oBAClEC,SAASC,IAAI,CAACC,SAAS,CAACC,MAAM,CAAC,oBAAoBN;oBAEnD,iDAAiD;oBACjD,IAAIxC,UAAU2C,SAASI,cAAc,CAAC;oBACtC,IAAI,CAAC/C,SAAS;wBACVA,UAAU2C,SAASK,aAAa,CAAC;wBACjChD,QAAQiD,EAAE,GAAG;wBACbjD,QAAQkD,KAAK,CAACC,OAAO,GAAG5B,YAAYxB,YAAYC,OAAO;wBAEvD,QAAQ;wBACR,IAAMoD,YAAYT,SAASK,aAAa,CAAC;wBACzCI,UAAUF,KAAK,CAAC9C,KAAK,GAAG;wBAExB,kBAAkB;wBAClB,IAAMiD,KAAKV,SAASK,aAAa,CAAC;wBAClCK,GAAGH,KAAK,CAACI,MAAM,GAAG;wBAClBD,GAAGH,KAAK,CAACK,YAAY,GAAG;wBAExB,cAAc;wBACd,IAAMC,aAAab,SAASK,aAAa,CAAC;wBAE1C,YAAY;wBACZ,IAAMS,YAAYd,SAASK,aAAa,CAAC;wBACzCS,UAAUP,KAAK,CAACC,OAAO,GAAG;wBAE1B,cAAc;wBACdnD,QAAQ0D,MAAM,CAACN,WAAWC,IAAIG,YAAYC;wBAE1C,mCAAmC;wBACnCzD,QAAQ2D,MAAM,GAAG;4BAAEC,OAAOR;4BAAWS,QAAQL;4BAAYM,OAAOL;wBAAU;wBAE1E,iBAAiB;wBACjBd,SAASC,IAAI,CAACmB,WAAW,CAAC/D;oBAC9B;oBAEA,mDAAmD;oBACnD,IAAIgE,mBAAmBrB,SAASI,cAAc,CAAC;oBAC/C,IAAI,CAACiB,kBAAkB;wBACnBA,mBAAmBrB,SAASK,aAAa,CAAC;wBAC1CgB,iBAAiBf,EAAE,GAAG;wBACtBe,iBAAiBd,KAAK,CAACC,OAAO,GAAG5B,YAAYxB,YAAYgB,OAAO;wBAChE4B,SAASC,IAAI,CAACmB,WAAW,CAACC;oBAC9B;oBAEA,gEAAgE;oBAChE,IAAIC,SAAS,GACTC,SAAS,GACTC,iBAAiB;oBAErB,4EAA4E;oBAC5E,IAAMC,cAAc,SAACC;wBACjBJ,SAASI,EAAEC,OAAO;wBAClBJ,SAASG,EAAEE,OAAO;wBAElB,+CAA+C;wBAC/CJ,iBAAiB,AAACE,CAAAA,EAAEG,YAAY,MAAM,EAAC,AAAC,EAAEC,IAAI,CAACC,SAAAA;mCAAQA,KAAKC,QAAQ,KAAK,KAAKD,KAAKE,YAAY,CAAC;;oBACpG;oBAEA,8BAA8B;oBAC9B,IAAIpC,QAAQ;wBACRG,SAASkC,gBAAgB,CAAC,aAAaT,aAAa;4BAAEU,SAAS;wBAAK;wBAEpE,0DAA0D;wBAC1D,IAAMC,aAAa;4BACf,IAAI,CAACC,sBAAsBvC,YAAY,CAACC,KAAK,EAAE;gCAC3CsB,iBAAiBiB,eAAe,IAAI,UAAU;gCAC9CjF,QAAQkD,KAAK,CAACpC,OAAO,GAAG;gCACxB6B,SAASuC,mBAAmB,CAAC,aAAad;gCAC1C;4BACJ;4BAEA,sDAAsD;4BACtD,IAAMe,aAAaxC,SAASyC,gBAAgB,CAAC,yBACzCC,WAAWrB,iBAAiBqB,QAAQ;4BACxC,IAAIC,eAAe;4BAEnB,2DAA2D;4BAC3DH,WAAWI,OAAO,CAAC,SAACC;gCAChB,IAAIC,OAAOD,GAAGE,qBAAqB;gCAEnC,kEAAkE;gCAClE,IAAID,KAAKvE,KAAK,KAAK,KAAKuE,KAAKtE,MAAM,KAAK,GAAG;oCACvC,IAAMwE,QAAQH,GAAGI,UAAU,GAAGJ,GAAGI,UAAU,CAACP,QAAQ,GAAGG,GAAGH,QAAQ;oCAClE,IAAIM,MAAME,MAAM,GAAG,GAAG;wCAClB,IAAIC,OAAOC,UACPC,OAAOD,UACPE,OAAO,CAACF,UACRG,OAAO,CAACH,UACRI,QAAQ;4CAGP,kCAAA,2BAAA;;4CADL,kEAAkE;4CAClE,QAAK,YAAeR,0BAAf,SAAA,6BAAA,QAAA,yBAAA,iCAAsB;gDAAtB,IAAMS,QAAN;gDACD,IAAMC,QAAQD,MAAMV,qBAAqB;gDACzC,IAAIW,MAAMnF,KAAK,GAAG,KAAKmF,MAAMlF,MAAM,GAAG,GAAG;oDACrCgF,QAAQ;oDACRL,OAAOQ,KAAKC,GAAG,CAACT,MAAMO,MAAMpF,IAAI;oDAChC+E,OAAOM,KAAKC,GAAG,CAACP,MAAMK,MAAMrF,GAAG;oDAC/BiF,OAAOK,KAAKE,GAAG,CAACP,MAAMI,MAAMI,KAAK;oDACjCP,OAAOI,KAAKE,GAAG,CAACN,MAAMG,MAAMK,MAAM;gDACtC;4CACJ;;4CATK;4CAAA;;;qDAAA,6BAAA;oDAAA;;;oDAAA;0DAAA;;;;wCAWL,qCAAqC;wCACrC,IAAIP,OACAV,OAAO;4CACHxE,MAAM6E;4CACN9E,KAAKgF;4CACL9E,OAAO+E,OAAOH;4CACd3E,QAAQ+E,OAAOF;wCACnB;oCACR;gCACJ;gCAEA,4CAA4C;gCAC5C,IAAIP,KAAKvE,KAAK,GAAG,KAAKuE,KAAKtE,MAAM,GAAG,KAChCsE,KAAKzE,GAAG,GAAG2F,OAAOC,WAAW,IAC7BnB,KAAKxE,IAAI,GAAG0F,OAAOE,UAAU,IAC7B,AAACpB,KAAKzE,GAAG,GAAGyE,KAAKtE,MAAM,GAAI,KAC3B,AAACsE,KAAKxE,IAAI,GAAGwE,KAAKvE,KAAK,GAAI,GAC7B;oCACE,uCAAuC;oCACvC,IAAI4F,MAAMzB,QAAQ,CAACC,aAAa;oCAChC,IAAI,CAACwB,KAAK;wCACNA,MAAMnE,SAASK,aAAa,CAAC;wCAC7B8D,IAAI5D,KAAK,CAACC,OAAO,GAAG5B,YAAYxB,YAAYsB,YAAY;wCACxD2C,iBAAiBD,WAAW,CAAC+C;oCACjC;oCAEA,oBAAoB;oCACpBA,IAAI5D,KAAK,CAAC6D,SAAS,GAAG,AAAC,aAA4BtB,OAAhBA,KAAKxE,IAAI,EAAC,QAAe,OAATwE,KAAKzE,GAAG,EAAC;oCAC5D8F,IAAI5D,KAAK,CAAChC,KAAK,GAAG,AAAC,GAAa,OAAXuE,KAAKvE,KAAK,EAAC;oCAChC4F,IAAI5D,KAAK,CAAC/B,MAAM,GAAG,AAAC,GAAc,OAAZsE,KAAKtE,MAAM,EAAC;oCAClC2F,IAAI5D,KAAK,CAACpC,OAAO,GAAG,SAAS,sBAAsB;oCAEnD,uBAAuB;oCACvBwE;gCACJ;4BACJ;4BAEA,gCAAgC;4BAChC,IAAK,IAAI0B,IAAI1B,cAAc0B,IAAI3B,SAASQ,MAAM,EAAEmB,IAC5C3B,QAAQ,CAAC2B,EAAE,CAAC9D,KAAK,CAACpC,OAAO,GAAG;4BAEhC,0CAA0C;4BAC1C,IAAIqD,gBAAgB;gCAChBnE,QAAQkD,KAAK,CAACpC,OAAO,GAAG;gCAExB,iBAAiB;gCACjBd,QAAQ2D,MAAM,CAACC,KAAK,CAACqD,WAAW,GAAG,AAAC,IAAqD,OAAlD9C,eAAe+C,YAAY,CAAC,uBAAsB;gCACzFlH,QAAQ2D,MAAM,CAACE,MAAM,CAACoD,WAAW,GAAG9C,eAAegD,QAAQ,GAAG,eAAe;gCAC7EnH,QAAQ2D,MAAM,CAACE,MAAM,CAACX,KAAK,CAAC9C,KAAK,GAAG+D,eAAegD,QAAQ,GAAG,YAAY;gCAE1E,oBAAoB;gCACpBnH,QAAQ2D,MAAM,CAACG,KAAK,CAACmD,WAAW,GAAGG,KAAKC,SAAS,CAAClD,eAAemD,MAAM,EAAE,MAAM;gCAE/E,4BAA4B;gCAC5B,IAAMC,SAAS,IACXC,QAAQxH,QAAQ0F,qBAAqB,IACrC+B,OAAOd,OAAOE,UAAU,EACxBa,OAAOf,OAAOC,WAAW;gCAE7B,sBAAsB;gCACtB,IAAI3F,OAAOgD,SAASsD,QAChBvG,MAAMkD,SAASqD;gCAEnB,uCAAuC;gCACvC,IAAItG,OAAOuG,MAAMtG,KAAK,GAAGuG,MACrBxG,OAAOgD,SAASuD,MAAMtG,KAAK,GAAGqG;gCAClC,IAAIvG,MAAMwG,MAAMrG,MAAM,GAAGuG,MACrB1G,MAAMkD,SAASsD,MAAMrG,MAAM,GAAGoG;gCAClC,IAAItG,OAAO,GACPA,OAAOsG;gCACX,IAAIvG,MAAM,GACNA,MAAMuG;gCAEV,kBAAkB;gCAClBvH,QAAQkD,KAAK,CAACjC,IAAI,GAAG,AAAC,GAAO,OAALA,MAAK;gCAC7BjB,QAAQkD,KAAK,CAAClC,GAAG,GAAG,AAAC,GAAM,OAAJA,KAAI;4BAC/B,OAAO;gCACHhB,QAAQkD,KAAK,CAACpC,OAAO,GAAG;4BAC5B;4BACA6G,sBAAsB5C;wBAC1B;wBACA4C,sBAAsB5C;oBAC1B;gBACJ;YACJ;;;WApMiB7C;;AADrB,gEAAgE;AAChE,SAAqBA,yBAqMpB","file":"ACLDebugger.js","sourcesContent":["/**\n * @license ACLDebugger\n *\n * Copyright (c) LTDev LLC\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// CSS for debugger\nconst debuggerCss = {\n    tooltip: {\n        position: 'fixed',\n        zIndex: 10000,\n        background: '#1f2937',\n        color: '#f3f4f6',\n        padding: '8px 12px',\n        borderRadius: '6px',\n        fontSize: '11px',\n        fontFamily: 'monospace',\n        pointerEvents: 'none',\n        border: '1px solid #374151',\n        boxShadow: '0 4px 6px -1px rgba(0,0,0,0.1)',\n        maxWidth: '300px',\n        whiteSpace: 'pre-wrap',\n        display: 'none',\n    },\n    overlay: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        pointerEvents: 'none',\n        zIndex: 9998,\n        overflow: 'hidden'\n    },\n    overlayBoxes: {\n        position: 'absolute',\n        border: '4px solid #22c55e',\n        boxSizing: 'border-box',\n    }\n};\n\n// Helper to convert JS style objects to CSS strings\nconst toCssString = (styleObj) => {\n    return Object.entries(styleObj)\n        .map(([k, v]) => `${k.replace(/[A-Z]/g, m => `-${m.toLowerCase()}`)}:${v}`)\n        .join(';');\n};\n\n// Debugger class to inject into the AlpineComponentLoader class\nexport default class ACLDebugger {\n    static inject(loaderClass) {\n        if (!loaderClass) {\n            console.error('[ACLDebugger] No ComponentLoader class provided to inject().');\n            return;\n        }\n\n        // Overwrite the stub method with the real implementation\n        loaderClass.toggleDebug = function () {\n            const active = (this.globalConfig.debug = !this.globalConfig.debug);\n            document.body.classList.toggle('acl-debug-active', active);\n\n            // Create the tooltip element if it doesn't exist\n            let tooltip = document.getElementById('acl-debug-tooltip');\n            if (!tooltip) {\n                tooltip = document.createElement('div');\n                tooltip.id = 'acl-debug-tooltip';\n                tooltip.style.cssText = toCssString(debuggerCss.tooltip);\n\n                // Title\n                const titleNode = document.createElement('strong');\n                titleNode.style.color = '#4ade80';\n\n                // Title separator\n                const hr = document.createElement('div');\n                hr.style.margin = '4px 0';\n                hr.style.borderBottom = '1px solid #374151';\n\n                // Status info\n                const statusNode = document.createElement('div');\n\n                // Prop info\n                const propsNode = document.createElement('pre');\n                propsNode.style.cssText = 'margin: 4px 0 0 0; opacity: 0.8;';\n\n                // Append once\n                tooltip.append(titleNode, hr, statusNode, propsNode);\n\n                // Save references for fast updates\n                tooltip._nodes = { title: titleNode, status: statusNode, props: propsNode };\n\n                // Append to body\n                document.body.appendChild(tooltip);\n            }\n\n            // Create the overlay container if it doesn't exist\n            let overlayContainer = document.getElementById('acl-debug-overlays');\n            if (!overlayContainer) {\n                overlayContainer = document.createElement('div');\n                overlayContainer.id = 'acl-debug-overlays';\n                overlayContainer.style.cssText = toCssString(debuggerCss.overlay);\n                document.body.appendChild(overlayContainer);\n            }\n\n            // State management, tracking hovered component + mouse position\n            let mouseX = 0,\n                mouseY = 0,\n                hoveredElement = null;\n\n            // Lightweight mouse listener for finding hovered component + mouse position\n            const onMouseMove = (e) => {\n                mouseX = e.clientX;\n                mouseY = e.clientY;\n\n                // Find hovered component (handling Shadow DOM)\n                hoveredElement = (e.composedPath() || []).find(node => node.nodeType === 1 && node.hasAttribute('data-acl-component'));\n            };\n\n            // If active, start debugging!\n            if (active) {\n                document.addEventListener('mousemove', onMouseMove, { passive: true });\n\n                // Render loop, with throttling, handles overlay + tooltip\n                const renderLoop = () => {\n                    if (!AlpineComponentLoader.globalConfig.debug) {\n                        overlayContainer.replaceChildren(); // Cleanup\n                        tooltip.style.display = 'none';\n                        document.removeEventListener('mousemove', onMouseMove);\n                        return;\n                    }\n\n                    // Overlay logic (DOM Pooling) for component positions\n                    const components = document.querySelectorAll('[data-acl-component]'),\n                        children = overlayContainer.children;\n                    let usedBoxCount = 0;\n\n                    // Measure all components recursively to find visible areas\n                    components.forEach((el) => {\n                        let rect = el.getBoundingClientRect();\n\n                        // Attempt to find visible area of children for collapsed elements\n                        if (rect.width === 0 && rect.height === 0) {\n                            const nodes = el.shadowRoot ? el.shadowRoot.children : el.children;\n                            if (nodes.length > 0) {\n                                let minX = Infinity,\n                                    minY = Infinity,\n                                    maxX = -Infinity,\n                                    maxY = -Infinity,\n                                    found = false;\n\n                                // Measure children recursively until we find a valid visible area\n                                for (const child of nodes) {\n                                    const cRect = child.getBoundingClientRect();\n                                    if (cRect.width > 0 || cRect.height > 0) {\n                                        found = true;\n                                        minX = Math.min(minX, cRect.left);\n                                        minY = Math.min(minY, cRect.top);\n                                        maxX = Math.max(maxX, cRect.right);\n                                        maxY = Math.max(maxY, cRect.bottom);\n                                    }\n                                }\n\n                                // Found a valid visible area, use it\n                                if (found)\n                                    rect = {\n                                        left: minX,\n                                        top: minY,\n                                        width: maxX - minX,\n                                        height: maxY - minY\n                                    };\n                            }\n                        }\n\n                        // Only draw if we have a valid visible area\n                        if (rect.width > 0 && rect.height > 0 &&\n                            rect.top < window.innerHeight &&\n                            rect.left < window.innerWidth &&\n                            (rect.top + rect.height) > 0 &&\n                            (rect.left + rect.width) > 0\n                        ) {\n                            // Reuse existing box or create new one\n                            let box = children[usedBoxCount];\n                            if (!box) {\n                                box = document.createElement('div');\n                                box.style.cssText = toCssString(debuggerCss.overlayBoxes);\n                                overlayContainer.appendChild(box);\n                            }\n\n                            // Fast style update\n                            box.style.transform = `translate(${rect.left}px, ${rect.top}px)`;\n                            box.style.width = `${rect.width}px`;\n                            box.style.height = `${rect.height}px`;\n                            box.style.display = 'block'; // Ensure it's visible\n\n                            // Count the used boxes\n                            usedBoxCount++;\n                        }\n                    });\n\n                    // Hide unused boxes in the pool\n                    for (let i = usedBoxCount; i < children.length; i++)\n                        children[i].style.display = 'none';\n\n                    // Tooltip logic, apply position + content\n                    if (hoveredElement) {\n                        tooltip.style.display = 'block';\n\n                        // Content Update\n                        tooltip._nodes.title.textContent = `<${hoveredElement.getAttribute('data-acl-component')}>`;\n                        tooltip._nodes.status.textContent = hoveredElement._loading ? 'Loading...' : 'Ready';\n                        tooltip._nodes.status.style.color = hoveredElement._loading ? '#fbbf24' : '#4ade80';\n\n                        // Display all props\n                        tooltip._nodes.props.textContent = JSON.stringify(hoveredElement.$props, null, 2);\n\n                        // Base position information\n                        const offset = 15,\n                            tRect = tooltip.getBoundingClientRect(),\n                            winW = window.innerWidth,\n                            winH = window.innerHeight;\n\n                        // Initial positioning\n                        let left = mouseX + offset,\n                            top = mouseY + offset;\n\n                        // Keep tooltip on screen within offset\n                        if (left + tRect.width > winW)\n                            left = mouseX - tRect.width - offset;\n                        if (top + tRect.height > winH)\n                            top = mouseY - tRect.height - offset;\n                        if (left < 0)\n                            left = offset;\n                        if (top < 0)\n                            top = offset;\n\n                        // Update position\n                        tooltip.style.left = `${left}px`;\n                        tooltip.style.top = `${top}px`;\n                    } else {\n                        tooltip.style.display = 'none';\n                    }\n                    requestAnimationFrame(renderLoop);\n                };\n                requestAnimationFrame(renderLoop);\n            }\n        }\n    }\n}"]}